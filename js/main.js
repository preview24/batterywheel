function safeRun(e){try{e()}catch(t){}}function openModal(e){let t=document.getElementById(e),l=t.querySelector(".modal-content");t.style.display="block",t.offsetHeight,setTimeout(()=>{t.classList.add("show"),l.classList.add("show")},10)}function closeModal(e){let t=document.getElementById(e),l=t.querySelector(".modal-content");t.classList.remove("show"),l.classList.remove("show"),t.classList.add("hide"),l.classList.add("hide"),setTimeout(()=>{t.style.display="none",t.classList.remove("hide"),l.classList.remove("hide")},500)}safeRun(function(){let e=document.getElementById("ebike-calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=(e,t,l)=>Math.min(Math.max(e,t),l),a=t("battery-capacity"),n=t("battery-unit"),r=t("voltage"),s=t("voltage-wrap"),o=t("range-unit"),i=t("motor-power"),c=t("rider-weight"),u=t("terrain"),d=t("pedal-assist"),p=t("calculate"),f=t("reset"),g=t("result"),h=t("range-output"),v=t("breakdown");function m(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t||"",l.style.display=t?"block":"none")}function $(){e.querySelectorAll(".error-message").forEach(e=>{e.style.display="none",e.textContent=""})}function y(){s.style.display="ah"===n.value?"block":"none"}function E(){$();let e=parseFloat(a.value);if(!e||e<=0){m(a,"Please enter a valid positive battery capacity."),a.focus();return}let t=0;if("ah"===n.value){let s=(r.value||"").trim(),p=""===s?48:parseFloat(s);if(!p||p<=0){m(r,"Please enter a valid voltage (V)."),r.focus();return}t=e*p}else t=e;let f=15,y={motor:1,weight:1,terrain:1,pedal:1},E=parseFloat(i.value);E&&E>0&&(y.motor=1+(E-250)/1e3,y.motor=l(y.motor,.6,2),f*=y.motor);let _=parseFloat(c.value);_&&_>0&&(y.weight=1+(_-75)/200,y.weight=l(y.weight,.7,1.6),f*=y.weight);let b=u.value;b&&(y.terrain=({flat:1,rolling:1.05,hilly:1.2,mountain:1.35})[b]||1,f*=y.terrain);let x=d.value;x&&(y.pedal=({none:.75,low:.85,medium:1,high:1.2})[x]||1,f*=y.pedal);let k=t/f,L=o.value,w="km"===L?`${k.toFixed(2)} km`:`${(k/1.609344).toFixed(2)} miles`;h.textContent=w,g.hidden=!1;let S=[];S.push(`<p class="f12 fade-left ad1"><strong>Battery:</strong> ${t.toLocaleString(void 0,{maximumFractionDigits:2})} Wh </p>`),S.push('<p class="f12 fade-left ad2"><strong>Baseline consumption:</strong> 15 Wh/km </p>'),S.push(`<p class="f12 fade-left ad3"><strong>Adjusted consumption:</strong> ${f.toFixed(2)} Wh/km </p>`);let C=[];1!==y.motor&&C.push(`Motor power \xd7${y.motor.toFixed(2)}`),1!==y.weight&&C.push(`Rider weight \xd7${y.weight.toFixed(2)}`),1!==y.terrain&&C.push(`Terrain \xd7${y.terrain.toFixed(2)}`),1!==y.pedal&&C.push(`Pedal assist \xd7${y.pedal.toFixed(2)}`),C.length&&S.push(`<strong>Applied factors:</strong> ${C.join(" • ")}`),S.push(`<p class="f12 fade-left ad4"><strong>Estimated range:</strong> ${w} </p>`),S.push('<p class="f12 fade-left ad5"><span class=small>Note: This is an estimate. Real-world range depends on riding style, wind, stops/starts, tire pressure and more.</span> </p>'),v.innerHTML=S.join("")}e.querySelectorAll("input[type=number]").forEach(e=>(function e(t){t.addEventListener("input",()=>{let e=t.value.replace(/[^0-9.]/g,""),l=e.split(".");l.length>2&&(e=l[0]+"."+l.slice(1).join("")),t.value=e})})(e)),n.addEventListener("change",y),y(),p.addEventListener("click",E),f.addEventListener("click",function e(){a.value="",n.value="ah",r.value="",o.value="km",i.value="",c.value="",u.value="",d.value="",g.hidden=!0,$(),y()}),a.addEventListener("keydown",e=>{"Enter"===e.key&&E()})}),safeRun(function(){let e="evcalc1_",t=document.getElementById(e+"battery"),l=document.getElementById(e+"cost"),a=document.getElementById(e+"unit"),n=document.getElementById(e+"charge"),r=document.getElementById(e+"display"),s=document.getElementById(e+"capacity_error"),o=document.getElementById(e+"cost_error"),i=document.getElementById(e+"result"),c=document.getElementById(e+"result_output"),u=document.getElementById(e+"btn"),d=document.getElementById(e+"reset");function p(e){let t=e.replace(/[^0-9.+-]/g,""),l=t.indexOf(".");-1!==l&&(t=t.slice(0,l+1)+t.slice(l+1).replace(/\./g,""));let a="";return("+"===t[0]||"-"===t[0])&&(a=t[0]),t=(a||"")+t.slice(a?1:0).replace(/[+-]/g,"")}function f(e){let t=e.target,l=t.value,a=t.selectionStart||l.length,n=p(l),r=l.slice(0,a),s=p(r),o=s.length;if(n!==l){t.value=n;try{t.setSelectionRange(o,o)}catch(i){}}}function g(){s.style.display="none",o.style.display="none"}[t,l].forEach(e=>{try{e.type="text"}catch(t){}e.setAttribute("inputmode","decimal"),e.setAttribute("autocapitalize","off"),e.setAttribute("autocomplete","off")}),[t,l].forEach(e=>{e.addEventListener("input",f),e.addEventListener("paste",t=>setTimeout(()=>f({target:e}),0)),e.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),u.click())})}),n.addEventListener("input",()=>{r.textContent=n.value+"%"}),u.addEventListener("click",()=>{g();let e=t.value.trim(),r=l.value.trim(),u=parseFloat(e),d=parseFloat(r),p=a.value,f=parseInt(n.value,10);if(isNaN(u)||u<=0){s.style.display="block";return}if(isNaN(d)||d<=0){o.style.display="block";return}let h=u;"Ah"===p&&(h=36*u/1e3);let v=h*(100-f)/100,m=[];m.push(`<h2 class="fade-left main-result">Total Charging Cost: &nbsp;  ${(v*d).toFixed(2)} </h2>`),m.push(`<p class="f12 fade-left ad1"><strong>Battery:</strong> ${h.toFixed(2)} kWh </p>`),m.push(`<p class="f12 fade-left ad2"><strong>Current Charge:</strong> ${f}% </p>`),m.push(`<p class="f12 fade-left ad3"><strong>Energy Needed:</strong> ${v.toFixed(2)} kWh </p>`),m.push(`<p class="f12 fade-left ad4"><strong>Cost per kWh:</strong> ${d.toFixed(2)} </p>`),c.innerHTML=m.join(""),i.hidden=!1}),d.addEventListener("click",()=>{t.value="",l.value="",a.value="Ah",n.value=0,r.textContent="0%",g(),i.hidden=!0})}),function(){let e=document.getElementById("battery-life-calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("bl_battery-capacity"),a=t("bl_battery-unit"),n=t("bl_voltage"),r=t("bl_voltage-wrap"),s=t("bl_daily-usage"),o=t("bl_usage-unit"),i=t("bl_charge-cycles"),c=t("bl_result"),u=t("bl_breakdown"),d=t("bl_calculate"),p=t("bl_reset");function f(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}function h(){r.style.display="ah"===a.value?"block":"none"}e.querySelectorAll("input[type=number]").forEach(e=>(function e(t){t.addEventListener("input",()=>{let e=t.value.replace(/[^0-9.]/g,""),l=e.split(".");l.length>2&&(e=l[0]+"."+l.slice(1).join("")),t.value=e})})(e)),a.addEventListener("change",h),h(),d.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0){f(l,"Enter valid positive battery capacity."),l.focus();return}let r=48;if("ah"===a.value){let d=n.value.trim();if(""!==d&&(r=parseFloat(d)),!r||r<=0){f(n,"Please enter a valid voltage."),n.focus();return}}let p=parseFloat(s.value);if(!p||p<=0){f(s,"Enter valid daily usage."),s.focus();return}let h=parseFloat(i.value);if(!h||h<=0){f(i,"Enter valid full charge cycles."),i.focus();return}let v="ah"===a.value?t*r:t,m=v*h,$=m/15,y=o.value,E="km"===y?`${$.toFixed(2)} km`:`${($/1.609344).toFixed(2)} miles`,_=`${(h/365).toFixed(2)} years (${(h/30).toFixed(1)} months)`;c.hidden=!1;let b=[];b.push(`<h2 class="fade-left main-result ad1"><strong>Estimated Battery Life:</strong> ${_}</h2>`),b.push(`<h3 class="fade-left main-result ad2"><strong>Estimated Total Range:</strong> ${E}</h3>`),b.push(`<p class="f12 fade-left ad3"><strong>Battery Energy:</strong> ${v.toLocaleString(void 0,{maximumFractionDigits:2})} Wh</p>`),b.push(`<p class="f12 fade-left ad4"><strong>Charge Cycles:</strong> ${h}</p>`),b.push(`<p class="f12 fade-left ad5"><strong>Total Lifetime Energy:</strong> ${m.toLocaleString(void 0,{maximumFractionDigits:0})} Wh</p>`),b.push("<p class=\"f12 fade-left ad6\"><span class='small'>Assuming one full charge per day and average consumption of 15 Wh/km.</span></p>"),u.innerHTML=b.join("")}),p.addEventListener("click",function e(){l.value="",a.value="ah",n.value="",s.value="",o.value="km",i.value="",c.hidden=!0,g(),h()})}(),function(){let e=document.getElementById("charging-time-calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ct_battery-capacity"),a=t("ct_capacity-unit"),n=t("ct_voltage"),r=t("ct_voltage-wrap"),s=t("ct_charger-current"),o=t("ct_efficiency"),i=t("ct_result"),c=t("ct_breakdown"),u=t("ct_calculate"),d=t("ct_reset");function p(){r.style.display="ah"===a.value?"block":"none"}function f(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0){f(l,"Enter valid positive capacity.");return}let r=48;if("ah"===a.value){let u=n.value.trim();if(""!==u&&(r=parseFloat(u)),!r||r<=0){f(n,"Enter valid voltage.");return}}let d=parseFloat(s.value);if(!d||d<=0){f(s,"Enter valid charger output current.");return}let p=parseFloat(o.value);(!p||p<=0||p>100)&&(p=90);let h="ah"===a.value?t*r:t,v=r*d*(p/100),m=h/v,$=Math.floor(m);i.hidden=!1;let y=[];y.push(`<h2 class="fade-left main-result ad1"><strong>Estimated Charging Time:</strong> ${$} h ${Math.round((m-$)*60)} min</h2>`),y.push(`<p class="f12 fade-left ad2"><strong>Battery Energy:</strong> ${h.toLocaleString(void 0,{maximumFractionDigits:1})} Wh</p>`),y.push(`<p class="f12 fade-left ad3"><strong>Charger Power:</strong> ${v.toLocaleString(void 0,{maximumFractionDigits:1})} W (at ${p}% efficiency)</p>`),y.push('<p class="f12 fade-left ad4"><span class="small">Actual time may vary due to charger tapering and BMS protection.</span></p>'),c.innerHTML=y.join("")}),d.addEventListener("click",function e(){l.value="",a.value="ah",n.value="",s.value="",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("motor-power-calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("mp_motor-power"),a=t("mp_wheel-size"),n=t("mp_total-weight"),r=t("mp_efficiency"),s=t("mp_position"),o=t("mp_grade"),i=t("mp_result"),c=t("mp_breakdown"),u=t("mp_calculate"),d=t("mp_reset");function p(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),u.addEventListener("click",function e(){var t;f();let u=parseFloat(l.value);if(!u||u<=0){p(l,"Enter valid motor power (W)."),l.focus();return}let d=parseFloat(a.value);if(!d||d<=0){p(a,"Enter valid wheel diameter (inch)."),a.focus();return}let g=parseFloat(n.value);if(!g||g<=0){p(n,"Enter valid total weight (kg)."),n.focus();return}let h=parseFloat(r.value);(!h||h<=0||h>100)&&(h=85);let v=h/100,m=s.value,$="tucked"===(t=m)?.4:"relaxed"===t?.7:.6,y=parseFloat(o.value)||0,E=function e(t,l,a,n,r,s,o){let i=t*o;if(i<=0)return 0;let c=.1,u=60;for(let d=0;d<80;d++){let p=(c+u)/2,f=.008*l*9.81+9.81*l*a,g=f*p+.6125*r*Math.pow(p,3);g>i?u=p:c=p}return(c+u)/2}(u,g,y,.008,$,1.225,v);i.hidden=!1;let _=[];_.push(`<h2 class="fade-left main-result ad1"><strong>Estimated Top Speed:</strong> ${(3.6*E).toFixed(1)} km/h</h2>`),_.push(`<p class="f12 fade-left ad2"><strong>Motor Power:</strong> ${u} W (at ${h}% system efficiency)</p>`),_.push(`<p class="f12 fade-left ad3"><strong>Total Weight:</strong> ${g.toFixed(0)} kg</p>`),_.push(`<p class="f12 fade-left ad4"><strong>Riding Position (CdA):</strong> ${m.charAt(0).toUpperCase()+m.slice(1)} — ${$.toFixed(2)} m\xb2</p>`),_.push(`<p class="f12 fade-left ad5"><strong>Wheel Size:</strong> ${d.toFixed(1)}" — ${(25.4*d).toFixed(0)} mm</p>`),_.push(`<p class="f12 fade-left ad6"><strong>Road Grade:</strong> ${(100*y).toFixed(1)} %</p>`),_.push('<p class="f12 fade-left ad7"><span class="small">Model uses rolling resistance + grade + aerodynamic drag. Real-world top speed also depends on gearing, controller limits, battery voltage under load, and wind.</span></p>'),c.innerHTML=_.join("")}),d.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="upright",o.value="0",i.hidden=!0,f()})}(),function(){let e=document.getElementById("ec100_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ec100_capacity"),a=t("ec100_unit"),n=t("ec100_voltage"),r=t("ec100_range"),s=t("ec100_cost"),o=t("ec100_result"),i=t("ec100_breakdown"),c=t("ec100_calculate"),u=t("ec100_reset"),d=t("ec100_voltage-wrap");function p(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}function g(){d.style.display="ah"===a.value?"block":"none"}a.addEventListener("change",g),g(),c.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0){p(l,"Enter valid battery capacity.");return}let c=48;if("ah"===a.value){let u=n.value.trim();if(""!==u&&(c=parseFloat(u)),!c||c<=0){p(n,"Enter valid voltage.");return}}let d=parseFloat(r.value);if(!d||d<=0){p(r,"Enter valid range per full charge.");return}let g=parseFloat(s.value);if(!g||g<=0){p(s,"Enter valid electricity cost.");return}let h="ah"===a.value?t*c:t,v=h/1e3;o.hidden=!1;let m=[];m.push(`<h2 class="fade-left main-result ad1"><strong>Electricity Cost per 100 km:</strong> ${(100*(v/d)*g).toFixed(2)} </h2>`),m.push(`<p class="f12 fade-left ad2"><strong>Cost per Full Charge:</strong> ${(v*g).toFixed(2)}</p>`),m.push(`<p class="f12 fade-left ad3"><strong>Battery Energy:</strong> ${v.toFixed(2)} kWh</p>`),m.push(`<p class="f12 fade-left ad4"><strong>Range per Charge:</strong> ${d.toFixed(1)} km</p>`),m.push('<p class="f12 fade-left ad5"><span class="small">Assuming full discharge and recharge each cycle. Actual cost may vary due to charger efficiency and terrain.</span></p>'),i.innerHTML=m.join("")}),u.addEventListener("click",function e(){l.value="",a.value="ah",n.value="",r.value="",s.value="",o.hidden=!0,f(),g()})}(),function(){let e=document.getElementById("co2_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("co2_distance"),a=t("co2_unit"),n=t("co2_vehicle"),r=t("co2_whkm"),s=t("co2_result"),o=t("co2_breakdown"),i=t("co2_calculate"),c=t("co2_reset");function u(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function d(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),i.addEventListener("click",function e(){d();let t=parseFloat(l.value);if(!t||t<=0){u(l,"Enter a valid distance.");return}let i=parseFloat(r.value||"15");if(!i||i<=0){u(r,"Enter valid Wh per km.");return}let c="km"===a.value?t:1.60934*t,p=72,f=p;"car"===n.value&&(f=192);let g=c*f,h=g-i*c/1e3*475,v=[];v.push(`<h2 class="fade-left"><strong>Daily CO₂ Saved:</strong> ${(h/1e3).toFixed(2)} kg</h2>`),v.push(`<h3 class="fade-left ad1"><strong>Monthly CO₂ Saved:</strong> ${(30*h/1e3).toFixed(2)} kg</h3>`),v.push(`<h3 class="fade-left ad2"><strong>Yearly CO₂ Saved:</strong> ${(365*h/1e3).toFixed(2)} kg</h3>`),v.push(`<p class="small fade-left ad3">Compared to: <strong>${"motorcycle"===n.value?"Petrol Motorcycle":"Petrol Car"}</strong></p>`),v.push(`<p class="small fade-left ad4">Based on average eBike consumption: <strong>${i} Wh/km</strong></p>`),o.innerHTML=v.join(""),s.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="km",n.value="motorcycle",r.value="",s.hidden=!0,d()})}(),function(){let e=document.getElementById("battery_replacement_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("br_capacity"),a=t("br_unit"),n=t("br_voltage"),r=t("br_voltage_wrap"),s=t("br_cycles"),o=t("br_price"),i=t("br_whkm"),c=t("br_result"),u=t("br_breakdown"),d=t("br_calculate"),p=t("br_reset");function f(){r.style.display="ah"===a.value?"block":"none"}function g(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),d.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0)return g(l,"Enter valid capacity.");let r=48;if("ah"===a.value&&(!(r=parseFloat(n.value||"48"))||r<=0))return g(n,"Enter valid voltage.");let d=parseFloat(s.value);if(!d||d<=0)return g(s,"Enter valid cycle count.");let p=parseFloat(o.value);if(!p||p<=0)return g(o,"Enter battery price.");let f=parseFloat(i.value||"15");if(!f||f<=0)return g(i,"Enter valid Wh/km.");let v="ah"===a.value?t*r:t,m=v*d,$=m/f,y=[];y.push(`<h2 class="fade-left"><strong>Cost per km:</strong> ${(p/$).toFixed(4)} </h2>`),y.push(`<h3 class="fade-left ad1"><strong>Total Lifetime Range:</strong> ${$.toFixed(0)} km (${(.621371*$).toFixed(0)} miles)</h3>`),y.push(`<p class="fade-left ad2"><strong>Total Energy Before Replacement:</strong> ${m.toLocaleString()} Wh</p>`),y.push(`<p class="fade-left ad3"><strong>Cost per Full Cycle:</strong> ${(p/d).toFixed(2)}</p>`),y.push(`<p class="fade-left ad4"><strong>Estimated Battery Life:</strong> ${(d/365).toFixed(2)} years (${(d/30).toFixed(1)} months)</p>`),y.push(`<p class="small fade-left ad5">Based on ${v} Wh battery, ${d} cycles, and ${f} Wh/km consumption.</p>`),u.innerHTML=y.join(""),c.hidden=!1}),p.addEventListener("click",function e(){l.value="",a.value="ah",n.value="",s.value="",o.value="",i.value="",c.hidden=!0,h(),f()})}(),function(){let e=document.getElementById("torque_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("tc_power"),a=t("tc_voltage"),n=t("tc_kv"),r=t("tc_gear"),s=t("tc_wheel"),o=t("tc_load"),i=t("tc_result"),c=t("tc_breakdown"),u=t("tc_calculate"),d=t("tc_reset");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),u.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid power.");let u=parseFloat(a.value);if(!u||u<=0)return p(a,"Enter valid voltage.");let d=parseFloat(n.value);if(!d||d<=0)return p(n,"Enter valid motor KV.");let g=parseFloat(r.value);if(!g||g<=0)return p(r,"Enter valid gear ratio.");let h=parseFloat(s.value);if(!h||h<=0)return p(s,"Enter wheel size.");let v=parseFloat(o.value);if(!v||v<=0)return p(o,"Enter valid weight.");let m=60*t/(2*Math.PI*(d*u)),$=m*g*.85,y=$/(.0254*h/2),E=[];E.push(`<h2 class="fade-left"><strong>Wheel Torque:</strong> ${$.toFixed(2)} Nm</h2>`),E.push(`<h3 class="fade-left ad1"><strong>Motor Torque:</strong> ${m.toFixed(2)} Nm</h3>`),E.push(`<p class="fade-left ad2"><strong>Wheel Force:</strong> ${y.toFixed(1)} N</p>`),E.push(`<p class="fade-left ad3"><strong>Acceleration:</strong> ${(y/(9.81*v)).toFixed(3)} g</p>`),E.push(`<p class="fade-left ad4"><strong>Estimated Climb Ability:</strong> ${(y/(9.81*v)*100).toFixed(1)}% grade</p>`),E.push(`<p class="small fade-left ad5">Based on KV = ${d}, gear ratio = ${g}, and ${h}&quot; wheel.</p>`),c.innerHTML=E.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",i.hidden=!0,f()})}(),function(){let e=document.getElementById("load_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("lc_power"),a=t("lc_voltage"),n=t("lc_wheel"),r=t("lc_rider"),s=t("lc_bike"),o=t("lc_result"),i=t("lc_breakdown"),c=t("lc_calculate"),u=t("lc_reset");function d(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),c.addEventListener("click",function e(){p();let t=parseFloat(l.value),c=parseFloat(a.value),u=parseFloat(n.value),f=parseFloat(r.value),g=parseFloat(s.value);if(!t||t<=0)return d(l,"Enter valid power.");if(!c||c<=0)return d(a,"Enter valid voltage.");if(!u||u<=0)return d(n,"Enter valid wheel size.");if(!f||f<=0)return d(r,"Enter rider weight.");if(!g||g<=0)return d(s,"Enter bike weight.");let h=.8*(60*t/(2*Math.PI*(4e4/(Math.PI*u*.0254)*60/1e3))),v=h/(.0254*u/2),m=v/9.81+g,$=m-f,y=[];y.push(`<h2 class="fade-left"><strong>Max Safe Total Load:</strong> ${m.toFixed(0)} kg</h2>`),y.push(`<h3 class="fade-left ad1"><strong>Max Cargo Capacity:</strong> ${$.toFixed(0)} kg</h3>`),y.push(`<h3 class="fade-left ad2"><strong>Recommended Safe Cargo:</strong> ${Math.max(0,.75*$).toFixed(0)} kg</h3>`),y.push(`<p class="fade-left ad3"><strong>Wheel Torque:</strong> ${h.toFixed(2)} Nm</p>`),y.push(`<p class="fade-left ad4"><strong>Estimated Wheel Force:</strong> ${v.toFixed(1)} N</p>`),y.push(`<p class="fade-left ad5"><strong>Range Reduction:</strong> ${($/(f+g)*12).toFixed(1)}% (when fully loaded)</p>`),y.push(`<p class="small fade-left ad6">Based on ${t}W motor, ${u}&quot; wheel, and ${c}V system.</p>`),i.innerHTML=y.join(""),o.hidden=!1}),u.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.hidden=!0,p()})}(),function(){let e=document.getElementById("hill_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("hc_power"),a=t("hc_weight"),n=t("hc_wheel"),r=t("hc_efficiency"),s=t("hc_slope"),o=t("hc_result"),i=t("hc_breakdown"),c=t("hc_calculate"),u=t("hc_reset");function d(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),c.addEventListener("click",function e(){p();let t=parseFloat(l.value),c=parseFloat(a.value),u=parseFloat(n.value),f=parseFloat(r.value),g=parseFloat(s.value);if(!t||t<=0)return d(l,"Enter valid power.");if(!c||c<=0)return d(a,"Enter valid weight.");if(!u||u<=0)return d(n,"Enter valid wheel size.");if(!f||f<=0||f>100)return d(r,"Enter valid efficiency.");let h=f/100,v=t*h/(10/3.6),m=Math.asin(Math.min(1,v/(9.81*c)))*(180/Math.PI),$="",y="";if(g){let E=9.81*c*Math.sin(Math.atan(g/100));$=v>=E?`<p class="fade-left ad3"><strong>You CAN climb ${g}% hill</strong> at approx <strong>${(y=3.6*(t*h/E)).toFixed(1)} km/h</strong>.</p>`:`<p class="fade-left ad1"><strong>You CANNOT climb ${g}% hill.</strong> Not enough motor force.</p>`}let _=[];_.push(`<h2 class="fade-left"><strong>Maximum Climbable Slope:</strong> ${(100*Math.tan(m*Math.PI/180)).toFixed(1)}%</h2>`),_.push(`<h3 class="fade-left ad2"><strong>Maximum Hill Angle:</strong> ${m.toFixed(1)}\xb0</h3>`),$&&_.push($),_.push(`<p class="fade-left ad4"><strong>Available Wheel Force:</strong> ${v.toFixed(1)} N</p>`),_.push(`<p class="small fade-left ad5">Based on ${t}W power, ${u}&quot; wheel, and ${f}% drivetrain efficiency.</p>`),i.innerHTML=_.join(""),o.hidden=!1}),u.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.hidden=!0,p()})}(),function(){let e=document.getElementById("efficiency_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ec_ideal"),a=t("ec_actual"),n=t("ec_capacity"),r=t("ec_unit"),s=t("ec_voltage_wrap"),o=t("ec_voltage"),i=t("ec_result"),c=t("ec_breakdown"),u=t("ec_calculate"),d=t("ec_reset");function p(){s.style.display="ah"===r.value?"block":"none"}function f(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),r.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter valid ideal Wh/km.");let s=parseFloat(a.value);if(!s||s<=0)return f(a,"Enter valid actual Wh/km.");let u=parseFloat(n.value);if(!u||u<=0)return f(n,"Enter valid battery capacity.");let d=48;if("ah"===r.value&&(!(d=parseFloat(o.value||"48"))||d<=0))return f(o,"Enter valid voltage.");let p="ah"===r.value?u*d:u,h=t/s*100,v=100-h,m=p/t,$=p/s,y=[];y.push(`<h2 class="fade-left"><strong>Efficiency:</strong> ${h.toFixed(1)}%</h2>`),y.push(`<h3 class="fade-left ad1"><strong>Total Energy Loss:</strong> ${v.toFixed(1)}%</h3>`),y.push(`<p class="fade-left ad2"><strong>Lost Energy per km:</strong> ${(s-t).toFixed(2)} Wh</p>`),y.push(`<p class="fade-left ad3"><strong>Ideal Range:</strong> ${m.toFixed(1)} km</p>`),y.push(`<p class="fade-left ad4"><strong>Actual Range:</strong> ${$.toFixed(1)} km</p>`),y.push(`<p class="fade-left ad5"><strong>Range Reduction:</strong> ${((m-$)/m*100).toFixed(1)}%</p>`),y.push('<h3 class="fade-left ad6">Loss Breakdown</h3>'),y.push(`<p class="fade-left ad7">Rolling Resistance: ${(.3*v).toFixed(1)}%</p>`),y.push(`<p class="fade-left ad8">Drivetrain Loss: ${(.2*v).toFixed(1)}%</p>`),y.push(`<p class="fade-left ad9">Wind Drag: ${(.4*v).toFixed(1)}%</p>`),y.push(`<p class="fade-left ad10">Other Losses: ${(.1*v).toFixed(1)}%</p>`),y.push(`<p class="small fade-left ad11">Based on ${p} Wh battery and Wh/km comparison.</p>`),c.innerHTML=y.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="ah",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("dod_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("dod_cycles"),a=t("dod_capacity"),n=t("dod_unit"),r=t("dod_voltage_wrap"),s=t("dod_voltage"),o=t("dod_percent"),i=t("dod_result"),c=t("dod_breakdown"),u=t("dod_calculate"),d=t("dod_reset");function p(){r.style.display="ah"===n.value?"block":"none"}function f(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),n.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter valid cycle rating.");let r=parseFloat(a.value);if(!r||r<=0)return f(a,"Enter valid battery capacity.");let u=parseFloat(o.value);if(!u||u<=0||u>100)return f(o,"Enter DoD between 1 and 100.");let d=48;if("ah"===n.value&&(!(d=parseFloat(s.value||"48"))||d<=0))return f(s,"Enter valid voltage.");let p="ah"===n.value?r*d:r,h=t*Math.pow(100/u,.7),v=[];v.push(`<h2 class="fade-left"><strong>Estimated Cycle Life:</strong> ${h.toFixed(0)} cycles</h2>`),v.push(`<h3 class="fade-left ad1"><strong>Battery Lifespan:</strong> ${(h/365).toFixed(2)} years</h3>`),v.push(`<p class="fade-left ad2"><strong>Life Increase:</strong> ${((h-t)/t*100).toFixed(1)}% compared to 100% DoD</p>`),v.push(`<p class="fade-left ad3"><strong>Total Usable Energy Over Lifetime:</strong> ${(h*p).toLocaleString()} Wh</p>`),v.push(`<p class="fade-left ad4"><strong>Recommended Optimal DoD:</strong> 20%–80% for best life</p>`),v.push(`<p class="small fade-left ad5">Based on ${p} Wh battery and ${t} rated cycles.</p>`),c.innerHTML=v.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="",n.value="ah",s.value="",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("temp_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("temp_cycles"),a=t("temp_capacity"),n=t("temp_unit"),r=t("temp_voltage_wrap"),s=t("temp_voltage"),o=t("temp_celsius"),i=t("temp_result"),c=t("temp_breakdown"),u=t("temp_calculate"),d=t("temp_reset");function p(){r.style.display="ah"===n.value?"block":"none"}function f(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),n.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter valid cycle rating.");let r=parseFloat(a.value);if(!r||r<=0)return f(a,"Enter valid battery capacity.");let u=48;if("ah"===n.value&&(!(u=parseFloat(s.value||"48"))||u<=0))return f(s,"Enter valid voltage.");let d=parseFloat(o.value);if(isNaN(d))return f(o,"Enter a valid temperature.");let p="ah"===n.value?r*u:r,h=Math.pow(2,(d-25)/10),v=t/h,m=[];m.push(`<h2 class="fade-left"><strong>Adjusted Cycle Life:</strong> ${v.toFixed(0)} cycles</h2>`),m.push(`<h3 class="fade-left ad1"><strong>Battery Lifespan:</strong> ${(v/365).toFixed(2)} years</h3>`),m.push(`<p class="fade-left ad2"><strong>Life Lost Due to Temperature:</strong> ${((t-v)/t*100).toFixed(1)}%</p>`),m.push(`<p class="fade-left ad3"><strong>Acceleration Factor:</strong> ${h.toFixed(2)}x faster aging</p>`),m.push(`<p class="fade-left ad4"><strong>Total Energy Over Lifetime:</strong> ${(p*v).toLocaleString()} Wh</p>`),m.push(`<p class="small fade-left ad5">Based on ${p} Wh battery at ${d}\xb0C.</p>`),m.push(`<p class="small fade-left ad6"><strong>Recommended Temperature:</strong> 10–30\xb0C for long battery life.</p>`),c.innerHTML=m.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="",n.value="ah",s.value="",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("monthly_cost_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("mcc_capacity"),a=t("mcc_unit"),n=t("mcc_voltage_wrap"),r=t("mcc_voltage"),s=t("mcc_price"),o=t("mcc_daily_usage"),i=t("mcc_result"),c=t("mcc_breakdown"),u=t("mcc_calculate"),d=t("mcc_reset");function p(){n.style.display="ah"===a.value?"block":"none"}function f(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter valid battery capacity.");let n=48;if("ah"===a.value&&(!(n=parseFloat(r.value||"48"))||n<=0))return f(r,"Enter valid voltage.");let u=parseFloat(s.value);if(!u||u<=0)return f(s,"Enter valid electricity price per kWh.");let d=parseFloat(o.value||"0"),p="ah"===a.value?t*n:t,h=(d||p)/1e3*u,v=[];v.push(`<h2 class="fade-left"><strong>Cost per Full Charge:</strong> ${(p/1e3*u).toFixed(2)}</h2>`),v.push(`<h3 class="fade-left ad1"><strong>Daily Charging Cost:</strong> ${h.toFixed(2)}</h3>`),v.push(`<p class="fade-left ad2"><strong>Monthly Charging Cost:</strong> ${(30*h).toFixed(2)}</p>`),v.push(`<p class="fade-left ad3"><strong>Yearly Charging Cost:</strong> ${(365*h).toFixed(2)}</p>`),v.push(`<p class="small fade-left ad4">Battery size: ${p} Wh | Electricity price: ${u} per kWh</p>`),c.innerHTML=v.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="ah",r.value="",s.value="",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("self_discharge_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("sd_capacity"),a=t("sd_unit"),n=t("sd_voltage_wrap"),r=t("sd_voltage"),s=t("sd_rate"),o=t("sd_days"),i=t("sd_result"),c=t("sd_breakdown"),u=t("sd_calculate"),d=t("sd_reset");function p(){n.style.display="ah"===a.value?"block":"none"}function f(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",p),p(),u.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter valid battery capacity.");let n=48;if("ah"===a.value&&(!(n=parseFloat(r.value||"48"))||n<=0))return f(r,"Enter valid voltage.");let u=parseFloat(s.value);if(!u||u<=0)return f(s,"Enter self-discharge rate.");let d=parseFloat(o.value);if(!d||d<=0)return f(o,"Enter valid number of days.");let p="ah"===a.value?t*n:t,h=Math.pow(1-u/100,1/30)-1,v=Math.pow(1+h,d),m=p*v;function $(e){let t=e/100;return t>=1?0:Math.log(t)/Math.log(1+h)}let y=$(80),E=$(50),_=$(20),b=[];b.push(`<h2 class="fade-left"><strong>Remaining Capacity:</strong> ${m.toFixed(2)} Wh (${(100*v).toFixed(1)}%)</h2>`),b.push(`<h3 class="fade-left ad1"><strong>Energy Lost:</strong> ${(p-m).toFixed(2)} Wh</h3>`),b.push(`<p class="fade-left ad2"><strong>Time to reach 80%:</strong> ${y.toFixed(0)} days</p>`),b.push(`<p class="fade-left ad3"><strong>Time to reach 50%:</strong> ${E.toFixed(0)} days</p>`),b.push(`<p class="fade-left ad4"><strong>Time to reach 20%:</strong> ${_.toFixed(0)} days</p>`),b.push(`<p class="small fade-left ad5">Based on ${p} Wh battery stored for ${d} days at ${u}% per month self-discharge.</p>`),c.innerHTML=b.join(""),i.hidden=!1}),d.addEventListener("click",function e(){l.value="",a.value="ah",r.value="",s.value="",o.value="",i.hidden=!0,g(),p()})}(),function(){let e=document.getElementById("calendar_aging_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ca_capacity"),a=t("ca_unit"),n=t("ca_voltage_wrap"),r=t("ca_voltage"),s=t("ca_years"),o=t("ca_temp"),i=t("ca_soc"),c=t("ca_result"),u=t("ca_breakdown"),d=t("ca_calculate"),p=t("ca_reset");function f(){n.style.display="ah"===a.value?"block":"none"}function g(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),d.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0)return g(l,"Enter valid capacity.");let n=48;if("ah"===a.value&&(!(n=parseFloat(r.value||"48"))||n<=0))return g(r,"Enter valid voltage.");let d=parseFloat(s.value);if(!d||d<=0)return g(s,"Enter valid years.");let p=parseFloat(o.value);if(isNaN(p))return g(o,"Enter valid temperature.");let f=parseFloat(i.value);if(!f||f<=0||f>100)return g(i,"Invalid SoC percentage.");let v="ah"===a.value?t*n:t,m=Math.pow(2,(p-25)/10),$=1;$=f>80?1.8:f>60?1.4:f>40?1:.8;let y=.03*m*$,E=100*Math.pow(1-y,d),_=m*$,b=[];b.push(`<h2 class="fade-left"><strong>Remaining Capacity:</strong> ${E.toFixed(1)}%</h2>`),b.push(`<h3 class="fade-left ad1"><strong>Total Loss After ${d} Years:</strong> ${(100-E).toFixed(1)}%</h3>`),b.push(`<p class="fade-left ad2"><strong>Remaining Energy:</strong> ${(v*(E/100)).toFixed(2)} Wh</p>`),b.push(`<p class="fade-left ad3"><strong>Aging Acceleration:</strong> ${_.toFixed(2)}\xd7 faster than ideal</p>`),b.push(`<p class="fade-left ad4"><strong>Annual Calendar Aging:</strong> ${(100*y).toFixed(2)}% per year</p>`),b.push(`
      <p class="small fade-left ad5">
      Best storage: 40–60% SoC at 15–25\xb0C.  
      Higher temperature and higher charge % cause faster chemical breakdown.
      </p>
    `),u.innerHTML=b.join(""),c.hidden=!1}),p.addEventListener("click",function e(){l.value="",a.value="ah",r.value="",s.value="",o.value="",i.value="",c.hidden=!0,h(),f()})}(),function(){let e=document.getElementById("solar_charging_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("sc_capacity"),a=t("sc_unit"),n=t("sc_voltage_wrap"),r=t("sc_voltage"),s=t("sc_panel_power"),o=t("sc_sun_hours"),i=t("sc_efficiency"),c=t("sc_result"),u=t("sc_breakdown"),d=t("sc_calculate"),p=t("sc_reset");function f(){n.style.display="ah"===a.value?"block":"none"}function g(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),d.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0)return g(l,"Enter valid battery capacity.");let n=48;if("ah"===a.value&&(!(n=parseFloat(r.value||"48"))||n<=0))return g(r,"Enter valid voltage.");let d=parseFloat(s.value);if(!d||d<=0)return g(s,"Enter valid solar panel watt rating.");let p=parseFloat(o.value);if(!p||p<=0)return g(o,"Enter valid sunlight hours.");let f=parseFloat(i.value);if(!f||f<=0||f>100)return g(i,"Enter 1–100% efficiency.");let v="ah"===a.value?t*n:t,m=d*(f/100),$=m*p,y=[];y.push(`<h2 class="fade-left"><strong>Solar Charging Time:</strong> ${(v/m).toFixed(2)} hours</h2>`),y.push(`<h3 class="fade-left ad1"><strong>Days Needed (with sunlight):</strong> ${(v/$).toFixed(2)} days</h3>`),y.push(`<p class="fade-left ad2"><strong>Usable Solar Power:</strong> ${m.toFixed(2)} W</p>`),y.push(`<p class="fade-left ad3"><strong>Daily Solar Production:</strong> ${$.toFixed(2)} Wh/day</p>`),y.push(`<p class="small fade-left ad4">Based on ${d}W panel, ${p}h sunlight and ${f}% efficiency.</p>`),u.innerHTML=y.join(""),c.hidden=!1}),p.addEventListener("click",function e(){l.value="",a.value="ah",r.value="",s.value="",o.value="",i.value="",c.hidden=!0,h(),f()})}(),function(){let e=document.getElementById("insurance_cost_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ic_bike_value"),a=t("ic_theft"),n=t("ic_accident"),r=t("ic_base_rate"),s=t("ic_result"),o=t("ic_breakdown"),i=t("ic_calculate"),c=t("ic_reset");function u(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function d(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),i.addEventListener("click",function e(){d();let t=parseFloat(l.value);if(!t||t<=0)return u(l,"Enter valid eBike value.");let i=parseFloat(a.value);if(!i||i<0)return u(a,"Enter valid theft risk.");let c=parseFloat(n.value);if(!c||c<0)return u(n,"Enter valid accident risk.");let p=parseFloat(r.value);if(!p||p<0)return u(r,"Enter valid base insurance rate.");let f=t*(p/100),g=t*(i/100),h=t*(c/100),v=f+g+h,m=[];m.push(`<h2 class="fade-left"><strong>Estimated Annual Insurance Cost:</strong> ${v.toFixed(2)}</h2>`),m.push(`<h3 class="fade-left ad1"><strong>Monthly Cost:</strong> ${(v/12).toFixed(2)}</h3>`),m.push(`<p class="fade-left ad2"><strong>Base Insurance Cost:</strong> ${f.toFixed(2)}</p>`),m.push(`<p class="fade-left ad3"><strong>Theft Risk Added:</strong> ${g.toFixed(2)}</p>`),m.push(`<p class="fade-left ad4"><strong>Accident Risk Added:</strong> ${h.toFixed(2)}</p>`),m.push('<p class="small fade-left ad5">These values are estimates based on user inputs and general risk factors.</p>'),o.innerHTML=m.join(""),s.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",d(),s.hidden=!0})}(),function(){let e=document.getElementById("battery_upgrade_checker");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("uc_old_voltage"),a=t("uc_new_voltage"),n=t("uc_controller_voltage"),r=t("uc_motor_voltage"),s=t("uc_bms_current"),o=t("uc_controller_current"),i=t("uc_check"),c=t("uc_reset"),u=t("uc_result"),d=t("uc_breakdown");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display=t?"block":"none")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),i.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid old voltage.");let i=parseFloat(a.value);if(!i||i<=0)return p(a,"Enter valid new voltage.");let c=parseFloat(n.value);if(!c||c<=0)return p(n,"Enter controller voltage limit.");let g=parseFloat(r.value);if(!g||g<=0)return p(r,"Enter motor nominal voltage.");let h=parseFloat(s.value);if(!h||h<=0)return p(s,"Enter battery BMS current.");let v=parseFloat(o.value);if(!v||v<=0)return p(o,"Enter controller current draw.");let m=i<=c,$=i>=.8*g&&i<=1.2*g,y=h>=v,E=[];E.push(`<h2 class="fade-left"><strong>Compatibility Result:</strong> ${m&&$&&y?"Compatible ✔":"Not Compatible ✖"}</h2>`),E.push(`<h3 class="fade-left ad1">Voltage Check:</h3>
      <p class="fade-left ad2">${m?"✔ Controller supports new voltage":"✖ New voltage exceeds controller limit"}</p>`),E.push(`<h3 class="fade-left ad3">Motor Compatibility:</h3>
      <p class="fade-left ad4">${$?"✔ Motor can run within safe voltage range":"✖ New voltage is unsafe for motor"}</p>`),E.push(`<h3 class="fade-left ad5">Current / BMS Check:</h3>
      <p class="fade-left ad6">${y?"✔ BMS can handle controller current":"✖ Controller current exceeds BMS capability"}</p>`),E.push(`<p class="small fade-left ad7">Ideal upgrade: Controller max V ≥ New battery V, Motor voltage within \xb120%, BMS current ≥ Controller current.</p>`),d.innerHTML=E.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",f(),u.hidden=!0})}(),function(){let e=document.getElementById("regen_brake_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("rg_voltage"),a=t("rg_capacity"),n=t("rg_weight"),r=t("rg_speed"),s=t("rg_stops"),o=t("rg_eff"),i=t("rg_calc"),c=t("rg_reset"),u=t("rg_result"),d=t("rg_breakdown");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),i.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid voltage.");let i=parseFloat(a.value);if(!i||i<=0)return p(a,"Enter valid capacity.");let c=parseFloat(n.value);if(!c||c<=0)return p(n,"Enter valid total weight.");let g=parseFloat(r.value);if(!g||g<=0)return p(r,"Enter valid speed.");let h=parseFloat(s.value);if(!h||h<=0)return p(s,"Enter number of stops.");let v=parseFloat(o.value);if(!v||v<=0)return p(o,"Enter regen efficiency.");let m=g/3.6,$=.5*c*m*m/3600*(v/100),y=$*h,E=[];E.push('<h2 class="fade-left"><strong>Regen Savings Summary</strong></h2>'),E.push(`<p class="fade-left ad1"><strong>Energy recovered per stop:</strong> ${$.toFixed(3)} Wh</p>`),E.push(`<p class="fade-left ad2"><strong>Total energy recovered per trip:</strong> ${y.toFixed(2)} Wh</p>`),E.push(`<p class="fade-left ad3"><strong>Extra range gained:</strong> ${(y/15).toFixed(2)} km</p>`),E.push('<p class="small fade-left ad4">Assuming typical eBike consumption of 15 Wh per km.</p>'),d.innerHTML=E.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",f(),u.hidden=!0})}(),function(){let e=document.getElementById("battery_replacement_predictor");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("br_capacity"),a=t("br_cycles"),n=t("br_daily"),r=t("br_age"),s=t("br_threshold"),o=t("br_calc"),i=t("br_reset"),c=t("br_result"),u=t("br_breakdown");function d(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),o.addEventListener("click",function e(){p();let t=parseFloat(l.value);if(!t||t<=0)return d(l,"Enter valid battery capacity.");let o=parseFloat(a.value);if(!o||o<=0)return d(a,"Enter valid rated cycles.");let i=parseFloat(n.value);if(!i||i<=0)return d(n,"Enter valid daily usage.");let f=parseFloat(r.value);if(!f||f<0)return d(r,"Enter valid battery age.");let g=parseFloat(s.value);if(!g||g<=0||g>100)return d(s,"Enter a threshold between 1 and 100.");let h=i/t,v=30*h*f,m=o*(g/100)-v;if(m<=0){u.innerHTML=`
        <h2 class="fade-left">Your battery has already reached the replacement threshold.</h2>
        <p class="fade-left">Estimated remaining life: 0 months.</p>`,c.hidden=!1;return}let $=m/h,y=$/30,E=new Date;E.setDate(E.getDate()+$);let _=E.toDateString(),b=[];b.push('<h2 class="fade-left"><strong>Estimated Time Until Replacement:</strong></h2>'),b.push(`<p class="fade-left ad1"><strong>${(y/12).toFixed(2)} years</strong> (${y.toFixed(1)} months)</p>`),b.push(`<p class="fade-left ad2"><strong>Days remaining:</strong> ${Math.round($)}</p>`),b.push(`<p class="fade-left ad3"><strong>Estimated replacement date:</strong> ${_}</p>`),b.push("<hr>"),b.push(`<p class="fade-left ad4"><strong>Rated cycle life:</strong> ${o}</p>`),b.push(`<p class="fade-left ad5"><strong>Cycles used so far:</strong> ${v.toFixed(1)}</p>`),b.push(`<p class="fade-left ad6"><strong>Cycles left until threshold:</strong> ${m.toFixed(1)}</p>`),u.innerHTML=b.join(""),c.hidden=!1}),i.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",c.hidden=!0,p()})}(),function(){let e=document.getElementById("battery_health_score_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("bh_capacity"),a=t("bh_cycles_rated"),n=t("bh_cycles_used"),r=t("bh_age"),s=t("bh_dod"),o=t("bh_temp"),i=t("bh_calc"),c=t("bh_reset"),u=t("bh_result"),d=t("bh_breakdown");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,""),l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),i.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid battery capacity.");let i=parseFloat(a.value);if(!i||i<=0)return p(a,"Enter valid rated cycle life.");let c=parseFloat(n.value);if(!c||c<0)return p(n,"Enter valid used cycles.");let g=parseFloat(r.value);if(!g||g<0)return p(r,"Enter valid battery age.");let h=parseFloat(s.value);if(!h||h<1||h>100)return p(s,"Depth of discharge must be 1–100%.");let v=parseFloat(o.value);if(!v||v<-20)return p(o,"Enter a reasonable temperature.");let m=100*(1-c/i),$=100-g/12*3,y=100-Math.max(0,(h-20)*.15),E=0;v>30&&(E=(v-30)*.8);let _=100-E,b=Math.max(0,Math.min(100,.45*m+.25*$+.15*y+.15*_)),x=g/12,k=[];k.push(`<h2 class="fade-left"><strong>Battery Health Score:</strong> ${b.toFixed(1)}%</h2>`),k.push('<h3 class="fade-left ad1">Health Breakdown</h3>'),k.push(`<p class="fade-left ad2"><strong>Cycle Aging Health:</strong> ${m.toFixed(1)}%</p>`),k.push(`<p class="fade-left ad3"><strong>Calendar Aging Health:</strong> ${$.toFixed(1)}%</p>`),k.push(`<p class="fade-left ad4"><strong>DoD Health:</strong> ${y.toFixed(1)}%</p>`),k.push(`<p class="fade-left ad5"><strong>Temperature Health:</strong> ${_.toFixed(1)}%</p>`),k.push(`<p class="fade-left ad6"><strong>Estimated Remaining Life:</strong> ${(x/(1-b/100)-x).toFixed(1)} years</p>`),k.push('<p class="small fade-left ad7">Based on EV-grade lithium battery degradation modeling.</p>'),d.innerHTML=k.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",f(),u.hidden=!0})}(),function(){let e=document.getElementById("motor_heat_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("mh_motor_power"),a=t("mh_load"),n=t("mh_resistance"),r=t("mh_voltage"),s=t("mh_airflow"),o=t("mh_ambient"),i=t("mh_calc"),c=t("mh_reset"),u=t("mh_result"),d=t("mh_breakdown");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}i.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid motor power.");let i=parseFloat(a.value);if(!i||i<=0)return p(a,"Enter valid load power.");let c=parseFloat(n.value);if(!c||c<=0)return p(n,"Enter valid resistance.");let g=parseFloat(r.value);if(!g||g<=0)return p(r,"Enter valid voltage.");let h=parseFloat(s.value);if(!h||h<1||h>10)return p(s,"Cooling factor must be 1–10.");let v=parseFloat(o.value);if(v<-20||isNaN(v))return p(o,"Enter valid temperature.");let m=i/g,$=m*m*c,y=$/(4*h),E=v+y,_="Safe";E>90?_="DANGER (Motor may overheat!)":E>75?_="High Risk":E>60&&(_="Moderate Heating");let b=[];b.push(`<h2 class="fade-left"><strong>Motor Temperature:</strong> ${E.toFixed(1)} \xb0C</h2>`),b.push(`<h3 class="fade-left ad1"><strong>Status:</strong> ${_}</h3>`),b.push(`<p class="fade-left ad2"><strong>Electrical current:</strong> ${m.toFixed(2)} A</p>`),b.push(`<p class="fade-left ad3"><strong>Copper (I\xb2R) heat loss:</strong> ${$.toFixed(1)} W</p>`),b.push(`<p class="fade-left ad4"><strong>Estimated temperature rise:</strong> ${y.toFixed(1)} \xb0C</p>`),b.push('<p class="small fade-left ad5">This is a simplified BLDC thermal estimation. Real motors may vary based on winding, ventilation & cooling fins.</p>'),d.innerHTML=b.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",u.hidden=!0,f()})}(),function(){let e=document.getElementById("voltage_sag_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("vs_voltage"),a=t("vs_ir"),n=t("vs_current"),r=t("vs_calc"),s=t("vs_reset"),o=t("vs_result"),i=t("vs_breakdown");function c(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function u(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value;(t=t.replace(/[^0-9.]/g,"")).startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),r.addEventListener("click",function e(){u();let t=parseFloat(l.value);if(!t||t<=0)return c(l,"Enter valid voltage.");let r=parseFloat(a.value);if(!r||r<=0)return c(a,"Enter valid internal resistance.");let s=parseFloat(n.value);if(!s||s<=0)return c(n,"Enter valid current.");let d=s*(r/1e3),p=d/t*100,f=[];f.push(`<h2 class="fade-left"><strong>Voltage Sag:</strong> ${d.toFixed(2)} V</h2>`),f.push(`<h3 class="fade-left ad1"><strong>Effective Voltage Under Load:</strong> ${(t-d).toFixed(2)} V</h3>`),f.push(`<p class="fade-left ad2"><strong>Sag Percentage:</strong> ${p.toFixed(1)}%</p>`),f.push(`<p class="fade-left ad3"><strong>Power Loss:</strong> ${(d*s).toFixed(1)} W</p>`),f.push(`<p class="fade-left ad4"><strong>Estimated Speed Loss:</strong> ${(.6*p).toFixed(1)}%</p>`),f.push(`<p class="fade-left ad5"><strong>Estimated Torque Loss:</strong> ${(.8*p).toFixed(1)}%</p>`),f.push('<p class="small fade-left ad6">This is a realistic approximation based on EV battery voltage sag behavior.</p>'),i.innerHTML=f.join(""),o.hidden=!1}),s.addEventListener("click",function e(){l.value="",a.value="",n.value="",u(),o.hidden=!0})}(),function(){let e=document.getElementById("payload_range_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("pr_capacity"),a=t("pr_base_weight"),n=t("pr_payload"),r=t("pr_consumption"),s=t("pr_calc"),o=t("pr_reset"),i=t("pr_result"),c=t("pr_breakdown");function u(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function d(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),s.addEventListener("click",function e(){d();let t=parseFloat(l.value);if(!t||t<=0)return u(l,"Enter valid battery capacity.");let s=parseFloat(a.value);if(!s||s<=0)return u(a,"Enter valid base weight.");let o=parseFloat(n.value);if(o<0||isNaN(o))return u(n,"Enter valid payload weight.");let p=parseFloat(r.value);if(!p||p<=0)return u(r,"Enter valid Wh/km.");let f=p*(1+.006*o),g=t/p,h=t/f,v=g-h,m=[];m.push(`<h2 class="fade-left"><strong>Updated Range:</strong> ${h.toFixed(2)} km</h2>`),m.push(`<h3 class="fade-left ad1"><strong>Range Loss:</strong> ${v.toFixed(2)} km (${(v/g*100).toFixed(1)}%)</h3>`),m.push(`<p class="fade-left ad2"><strong>Base Range:</strong> ${g.toFixed(2)} km</p>`),m.push(`<p class="fade-left ad3"><strong>Base Consumption:</strong> ${p.toFixed(1)} Wh/km</p>`),m.push(`<p class="fade-left ad4"><strong>New Consumption:</strong> ${f.toFixed(2)} Wh/km</p>`),m.push('<p class="small fade-left ad5">Extra load increases rolling resistance, causing higher Wh/km consumption. This model uses realistic EV-grade load impact coefficients.</p>'),c.innerHTML=m.join(""),i.hidden=!1}),o.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",d(),i.hidden=!0})}(),function(){let e=document.getElementById("terrain_resistance_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("tr_weight"),a=t("tr_speed"),n=t("tr_grade"),r=t("tr_rr"),s=t("tr_drag"),o=t("tr_wheel"),i=t("tr_calc"),c=t("tr_reset"),u=t("tr_result"),d=t("tr_breakdown");function p(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}i.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid weight.");let i=parseFloat(a.value);if(!i||i<=0)return p(a,"Enter valid speed.");let c=parseFloat(n.value);if(isNaN(c))return p(n,"Enter valid gradient.");let g=parseFloat(r.value);if(!g||g<=0)return p(r,"Enter valid Crr.");let h=parseFloat(s.value);(!h||h<=0)&&(h=.6);let v=parseFloat(o.value);if(!v||v<=0)return p(o,"Enter valid wheel radius.");let m=i/3.6,$=9.81*t*g,y=9.81*t*Math.sin(Math.atan(c/100)),E=.6125*h*m*m,_=$+y+E,b=_*m,x=b/m/.85/3.6,k=e=>(e/x).toFixed(1),L=[];L.push(`<h2 class="fade-left"><strong>Total Required Power:</strong> ${b.toFixed(1)} W</h2>`),L.push(`<h3 class="fade-left ad1"><strong>Total Resistance Force:</strong> ${_.toFixed(1)} N</h3>`),L.push(`<p class="fade-left ad2"><strong>Rolling Resistance:</strong> ${$.toFixed(2)} N</p>`),L.push(`<p class="fade-left ad3"><strong>Gradient Force:</strong> ${y.toFixed(2)} N</p>`),L.push(`<p class="fade-left ad4"><strong>Aerodynamic Drag:</strong> ${E.toFixed(2)} N</p>`),L.push(`<p class="fade-left ad5"><strong>Required Torque at Wheel:</strong> ${(_*v).toFixed(2)} Nm</p>`),L.push(`<p class="fade-left ad6"><strong>Estimated Consumption:</strong> ${x.toFixed(2)} Wh/km</p>`),L.push('<h4 class="fade-left ad7"><strong>Estimated Range:</strong></h4>'),L.push(`<p class="fade-left ad8">With 500 Wh battery: ${k(500)} km</p>`),L.push(`<p class="fade-left ad9">With 750 Wh battery: ${k(750)} km</p>`),L.push(`<p class="fade-left ad10">With 1000 Wh battery: ${k(1e3)} km</p>`),L.push('<p class="small fade-left ad11">Calculations follow real physics for rolling resistance, aerodynamic drag, and gravitational load.</p>'),d.innerHTML=L.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",f(),u.hidden=!0})}(),function(){let e=document.getElementById("wheel_ratio_speed_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("wr_motor_rpm"),a=t("wr_gear_ratio"),n=t("wr_wheel_diameter"),r=t("wr_tire_height"),s=t("wr_calc"),o=t("wr_reset"),i=t("wr_result"),c=t("wr_breakdown");function u(e,t){let l=e.nextElementSibling.nextElementSibling;l&&l.classList.contains("error-message")&&(l.textContent=t,l.style.display="block")}function d(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),s.addEventListener("click",function e(){d();let t=parseFloat(l.value);if(!t||t<=0)return u(l,"Enter valid RPM.");let s=parseFloat(a.value);if(!s||s<=0)return u(a,"Enter valid gear ratio.");let o=parseFloat(n.value);if(!o||o<=0)return u(n,"Enter valid wheel diameter.");let p=parseFloat(r.value);if(!p||p<=0)return u(r,"Enter valid tire height.");let f=o+2*p,g=.0254*f,h=Math.PI*g,v=t/s,m=60*(h*v)/1e3,$=[];$.push(`<h2 class="fade-left"><strong>Top Speed:</strong> ${m.toFixed(1)} km/h</h2>`),$.push(`<h3 class="fade-left ad1"><strong>Top Speed:</strong> ${(.621371*m).toFixed(1)} mph</h3>`),$.push(`<p class="fade-left ad2"><strong>Wheel RPM:</strong> ${v.toFixed(2)} rpm</p>`),$.push(`<p class="fade-left ad3"><strong>Wheel Diameter:</strong> ${f.toFixed(2)} in (${g.toFixed(3)} m)</p>`),$.push(`<p class="fade-left ad4"><strong>Circumference:</strong> ${h.toFixed(3)} m</p>`),$.push(`<p class="small fade-left ad5">This calculator uses wheel circumference \xd7 wheel RPM to determine realistic eBike top speed.</p>`),c.innerHTML=$.join(""),i.hidden=!1}),o.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",d(),i.hidden=!0})}(),function(){let e=document.getElementById("c_rate_calculator");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("cr_capacity"),a=t("cr_unit"),n=t("cr_voltage_wrap"),r=t("cr_voltage"),s=t("cr_controller_current"),o=t("cr_bms_current"),i=t("cr_desired_c"),c=t("cr_calc"),u=t("cr_reset"),d=t("cr_result"),p=t("cr_breakdown");function f(){"ah"===a.value?(n.style.display="none",r.value=""):n.style.display="block"}function g(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value;(t=t.replace(/[^0-9.]/g,"")).startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),c.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0){g(l,"Enter valid battery capacity."),l.focus();return}let n;if("ah"===a.value)n=t;else{let c=r.value.trim(),u=""!==c?parseFloat(c):NaN;if(!u||u<=0){g(r,"Enter valid voltage to convert Wh → Ah."),r.focus();return}n=t/u}if(!n||n<=0){g(l,"Converted capacity (Ah) is invalid.");return}let f=parseFloat(s.value);if(!f||f<=0){g(s,"Enter controller continuous current."),s.focus();return}let v=parseFloat(o.value);if(!v||v<=0){g(o,"Enter BMS continuous current."),o.focus();return}let m=parseFloat(i.value)||null,$=f/n,y=m?m*n:null,E="Safe",_="";v<f?(E="UNSAFE",_="BMS continuous current is LOWER than controller draw."):$>5?(E="Danger",_="Required C-rate exceeds 5C — extreme stress on batteries."):$>3?(E="High Risk",_="Required C-rate above 3C — many cells may overheat."):$>1.5?(E="Warning",_="Required C-rate between 1.5–3C — monitor battery temperature."):(E="Safe",_="Battery is well within safe C-rate range.");let b=[];b.push(`<h2 class="fade-left"><strong>Required C-rate:</strong> ${$.toFixed(3)} C</h2>`),b.push(`<h3 class="fade-left ad1"><strong>Battery Capacity Used:</strong> ${n.toFixed(3)} Ah</h3>`),b.push(`<p class="fade-left ad2"><strong>Controller Continuous:</strong> ${f.toFixed(2)} A</p>`),b.push(`<p class="fade-left ad3"><strong>BMS Continuous:</strong> ${v.toFixed(2)} A</p>`),m&&b.push(`<p class="fade-left ad4"><strong>Max Current at ${m}C:</strong> ${y.toFixed(2)} A</p>`),b.push(`<p class="fade-left ad5"><strong>BMS Margin:</strong> ${(v-f).toFixed(2)} A (${((v/f-1)*100).toFixed(1)}%)</p>`),b.push(`<p class="fade-left ad6"><strong>Safety Level:</strong> ${E}</p>`),b.push(`<p class="fade-left ad7">${_}</p>`),b.push(`<p class="small fade-left ad8">Minimum safe C-rate for your controller: <strong>${$.toFixed(3)}C</strong>.</p>`),p.innerHTML=b.join(""),d.hidden=!1}),u.addEventListener("click",function e(){l.value="",a.value="ah",r.value="",s.value="",o.value="",i.value="",h(),d.hidden=!0,f()})}(),function(){let e=document.getElementById("battery_ir_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ir_v_open"),a=t("ir_v_load"),n=t("ir_current"),r=t("ir_calc"),s=t("ir_reset"),o=t("ir_result"),i=t("ir_breakdown");function c(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function u(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),r.addEventListener("click",function e(){u();let t=parseFloat(l.value);if(!t||t<=0){c(l,"Enter valid open-circuit voltage.");return}let r=parseFloat(a.value);if(!r||r<=0||r>=t){c(a,"Load voltage must be less than open voltage.");return}let s=parseFloat(n.value);if(!s||s<=0){c(n,"Enter valid load current.");return}let d=t-r,p=d/s,f=1e3*p,g="",h="Unknown";f<50?(h="Excellent",g="IR is extremely low — high quality pack or new battery."):f<100?(h="Good",g="Battery is healthy and performing well."):f<150?(h="Fair",g="Some aging detectable — performance slightly reduced."):f<250?(h="Poor",g="Battery aging noticeably — expect voltage sag under load."):(h="Very Poor",g="High resistance — battery weak, unsafe for high loads.");let v=[];v.push(`<h2 class="fade-left"><strong>Internal Resistance:</strong> ${f.toFixed(2)} mΩ</h2>`),v.push(`<p class="fade-left ad1"><strong>Voltage Drop:</strong> ${d.toFixed(3)} V</p>`),v.push(`<p class="fade-left ad2"><strong>Power Lost as Heat:</strong> ${(s*s*p).toFixed(2)} W</p>`),v.push("<hr>"),v.push('<p class="fade-left ad3"><strong>Predicted Voltage Sag:</strong></p>'),v.push(`<p class="fade-left ad4">• At 10A: ${(10*p).toFixed(3)} V</p>`),v.push(`<p class="fade-left ad5">• At 20A: ${(20*p).toFixed(3)} V</p>`),v.push(`<p class="fade-left ad6">• At 30A: ${(30*p).toFixed(3)} V</p>`),v.push("<hr>"),v.push(`<h3 class="fade-left ad7"><strong>Battery Condition:</strong> ${h}</h3>`),v.push(`<p class="fade-left ad8">${g}</p>`),v.push('<p class="small fade-left ad9">Internal resistance is one of the strongest indicators of battery health. Lower IR = higher performance, less heat, and better lifespan.</p>'),i.innerHTML=v.join(""),o.hidden=!1}),s.addEventListener("click",function e(){l.value="",a.value="",n.value="",u(),o.hidden=!0})}(),function(){let e=document.getElementById("battery_charge_efficiency_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("bce_capacity"),a=t("bce_cap_mode"),n=t("bce_voltage_wrap"),r=t("bce_voltage"),s=t("bce_charger_power"),o=t("bce_charge_time"),i=t("bce_cost"),c=t("bce_calc"),u=t("bce_reset"),d=t("bce_result"),p=t("bce_breakdown");function f(){n.style.display="ah"===a.value?"block":"none"}function g(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),c.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0){g(l,"Enter valid battery capacity.");return}let n;if("ah"===a.value){let c=parseFloat(r.value);if(!c||c<=0){g(r,"Enter voltage.");return}n=t*c}else n=t;let u=parseFloat(s.value);if(!u||u<=0){g(s,"Enter valid charger power.");return}let f=parseFloat(o.value);if(!f||f<=0){g(o,"Enter valid charging time.");return}let v=parseFloat(i.value)||null,m=u*f,$=n/m*100,y=Math.max(m-n,0),E=null;v&&y>0&&(E=y/1e3*v);let _="";_=$>100?"⚠️ Your input values imply more energy stored than supplied. Check inputs.":$<60?"⚠️ Efficiency is very low — charger or battery may be old or overheating.":"Charging efficiency is within typical range (70%–92%).";let b=[];b.push(`<h2 class="fade-left"><strong>Charging Efficiency:</strong> ${$.toFixed(1)}%</h2>`),b.push(`<p class="fade-left ad1"><strong>Energy Supplied to Charger:</strong> ${m.toFixed(1)} Wh</p>`),b.push(`<p class="fade-left ad2"><strong>Energy Stored in Battery:</strong> ${n.toFixed(1)} Wh</p>`),b.push(`<p class="fade-left ad3"><strong>Energy Lost as Heat:</strong> ${y.toFixed(1)} Wh</p>`),null!==E&&b.push(`<p class="fade-left ad4"><strong>Cost of Wasted Energy:</strong> ${E.toFixed(3)}</p>`),b.push("<hr>"),b.push(`<p class="fade-left ad5">${_}</p>`),b.push(`<p class="small fade-left ad6">Most lithium battery chargers operate at 80–92% efficiency.</p>`),p.innerHTML=b.join(""),d.hidden=!1}),u.addEventListener("click",function e(){l.value="",r.value="",s.value="",o.value="",i.value="",d.hidden=!0,h(),f()})}(),function(){let e=document.getElementById("tiny_wh_ah_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ta_value"),a=t("ta_mode"),n=t("ta_voltage_wrap"),r=t("ta_voltage"),s=t("ta_calc"),o=t("ta_reset"),i=t("ta_result"),c=t("ta_output");function u(){n.style.display="wh_to_ah"===a.value?"block":"none","ah_to_wh"===a.value&&(r.value="")}function d(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",u),u(),s.addEventListener("click",function e(){p();let t=parseFloat(l.value);if(!t||t<=0){d(l,"Enter a valid number.");return}let n="";if("wh_to_ah"===a.value){let s=r.value.trim(),o=""!==s?parseFloat(s):NaN;if(!o||o<=0){d(r,"Enter valid voltage.");return}n=`<h3 class="fade-left">Result: <strong>${(t/o).toFixed(3)} Ah</strong></h3>`}else n=`<h3 class="fade-left ad1">Result: <strong>${(48*t).toFixed(1)} Wh</strong></h3>
                <p class="small fade-left ad2">Using default 48V (modify if needed).</p>`;c.innerHTML=n,i.hidden=!1}),o.addEventListener("click",function e(){l.value="",r.value="",i.hidden=!0,p(),u()})}(),function(){let e=document.getElementById("pack_builder_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("pb_cell_type"),a=t("pb_cell_voltage"),n=t("pb_cell_capacity"),r=t("pb_cell_maxa"),s=t("pb_series"),o=t("pb_parallel"),i=t("pb_calc"),c=t("pb_reset"),u=t("pb_result"),d=t("pb_breakdown"),p={18650:{v:3.6,mAh:3400,maxA:5},21700:{v:3.6,mAh:5e3,maxA:10},pouch:{v:3.7,mAh:1e4,maxA:10}};function f(){let e=l.value;if("custom"===e)return;let t=p[e];t&&(a.value=t.v,n.value=t.mAh,r.value=t.maxA)}function g(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}function f(){let e=l.value;if("custom"===e)return;let t=p[e];t&&(a.value=t.v,n.value=t.mAh,r.value=t.maxA)}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value;(t=t.replace(/[^0-9.]/g,"")).startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),l.addEventListener("change",f),f(),i.addEventListener("click",function e(){h();let t=parseFloat(a.value);if(!t||t<=0){g(a,"Enter valid cell nominal voltage (V).");return}let l=parseFloat(n.value);if(!l||l<=0){g(n,"Enter valid cell capacity in mAh.");return}let i=l/1e3,c=parseFloat(r.value);if(!c||c<=0){g(r,"Enter valid cell max continuous current (A).");return}let p=Math.floor(parseFloat(s.value));if(!p||p<=0){g(s,"Enter valid number of series cells (S).");return}let f=Math.floor(parseFloat(o.value));if(!f||f<=0){g(o,"Enter valid number of parallel cells (P).");return}let v=t*p,m=i*f,$=c*f,y=$/m,E=[];y>=5?E.push("High C-rate pack (≥5C) — suitable for high-power applications but ensure good cooling."):y>=2.5?E.push("Moderate C-rate (2.5–5C) — typical for many ebike packs."):E.push("Low C-rate (<2.5C) — pack favors capacity over high discharge."),v>60&&E.push("Pack nominal voltage >60V — ensure controller & BMS support this voltage.");let _=[];_.push(`<h2 class="fade-left"><strong>Pack Summary (${p}S \xd7 ${f}P):</strong></h2>`),_.push(`<p class="fade-left ad1"><strong>Cells used:</strong> ${p*f} cells</p>`),_.push(`<p class="fade-left ad2"><strong>Pack Nominal Voltage:</strong> ${v.toFixed(2)} V</p>`),_.push(`<p class="fade-left ad3"><strong>Pack Capacity:</strong> ${m.toFixed(3)} Ah (${Math.round(1e3*m)} mAh)</p>`),_.push(`<p class="fade-left ad4"><strong>Total Energy:</strong> ${(v*m).toFixed(1)} Wh</p>`),_.push(`<p class="fade-left ad5"><strong>Max Continuous Current (pack):</strong> ${$.toFixed(2)} A</p>`),_.push(`<p class="fade-left ad6"><strong>Max Continuous Power:</strong> ${(v*$).toFixed(1)} W</p>`),_.push(`<p class="fade-left ad7"><strong>Pack Continuous C (approx):</strong> ${y.toFixed(2)} C</p>`),_.push("<hr>"),_.push('<h3 class="fade-left ad8">Cell Specs (per cell)</h3>'),_.push(`<p class="fade-left ad9"><strong>Cell nominal voltage:</strong> ${t.toFixed(2)} V</p>`),_.push(`<p class="fade-left ad10"><strong>Cell capacity:</strong> ${i.toFixed(3)} Ah (${Math.round(l)} mAh)</p>`),_.push(`<p class="fade-left ad11"><strong>Cell max continuous:</strong> ${c.toFixed(2)} A</p>`),E.length&&(_.push("<hr>"),_.push('<h4 class="fade-left ad12">Notes</h4>'),E.forEach(e=>_.push(`<p class="fade-left ad13 small">• ${e}</p>`))),_.push('<p class="small fade-left ad14">These are nominal calculations. For pack building always consider cell balancing, BMS ratings, wiring, fuses, and thermal management.</p>'),d.innerHTML=_.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="18650",f(),s.value="",o.value="",h(),u.hidden=!0}),l.addEventListener("change",f)}(),function(){let e=document.getElementById("cell_chemistry_pack_builder");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("cc_cell_type"),a=t("cc_voltage"),n=t("cc_capacity"),r=t("cc_maxA"),s=t("cc_series"),o=t("cc_parallel"),i=t("cc_calc"),c=t("cc_reset"),u=t("cc_result"),d=t("cc_breakdown");e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})});let p={lifepo4:{v:3.2,mAh:6e3,maxA:30,cycles:"2500–6000 cycles"},lto:{v:2.3,mAh:1500,maxA:30,cycles:"5000–20000 cycles"},solidstate:{v:3.8,mAh:5e3,maxA:10,cycles:"1200–3000 cycles"},sodium:{v:3,mAh:4e3,maxA:6,cycles:"2000+ cycles"},lisulfur:{v:2.1,mAh:8e3,maxA:5,cycles:"100–500 cycles (experimental)"}};function f(){let e=l.value;if("custom"===e)return;let t=p[e];a.value=t.v,n.value=t.mAh,r.value=t.maxA}function g(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display="block")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}l.addEventListener("change",f),f(),i.addEventListener("click",function e(){h();let t=parseFloat(a.value);if(!t||t<=0)return g(a,"Enter valid voltage.");let i=parseFloat(n.value);if(!i||i<=0)return g(n,"Enter valid capacity.");let c=parseFloat(r.value);if(!c||c<=0)return g(r,"Enter valid max current.");let f=Math.floor(parseFloat(s.value));if(!f||f<=0)return g(s,"Enter valid series count.");let v=Math.floor(parseFloat(o.value));if(!v||v<=0)return g(o,"Enter valid parallel count.");let m=t*f,$=i/1e3*v,y=c*v,E="—";"custom"!==l.value&&(E=p[l.value].cycles);let _=[];_.push(`<h2 class="fade-left"><strong>${f}S \xd7 ${v}P Pack Built</strong></h2>`),_.push(`<p class="fade-left ad1"><strong>Total Cells:</strong> ${f*v}</p>`),_.push(`<p class="fade-left ad2"><strong>Pack Voltage:</strong> ${m.toFixed(2)} V</p>`),_.push(`<p class="fade-left ad3"><strong>Pack Capacity:</strong> ${$.toFixed(2)} Ah</p>`),_.push(`<p class="fade-left ad4"><strong>Total Energy:</strong> ${(m*$).toFixed(1)} Wh</p>`),_.push(`<p class="fade-left ad5"><strong>Max Continuous Current:</strong> ${y.toFixed(1)} A</p>`),_.push(`<p class="fade-left ad6"><strong>Max Continuous Power:</strong> ${(y*m).toFixed(1)} W</p>`),_.push(`<p class="fade-left ad7"><strong>Estimated Cycle Life (Chemistry):</strong> ${E}</p>`),"lifepo4"===l.value&&_.push(`<p class="small fade-left ad8">LFP performs poorly below 0\xb0C during charging.</p>`),"lto"===l.value&&_.push('<p class="small fade-left ad9">LTO is excellent for cold climates and ultra-long life.</p>'),d.innerHTML=_.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="lifepo4",f(),a.value=n.value=r.value="",s.value=o.value="",u.hidden=!0,h()})}(),function(){let e=document.getElementById("battery_runtime_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("br_capacity"),a=t("br_unit"),n=t("br_voltage_wrap"),r=t("br_voltage"),s=t("br_load"),o=t("br_eff"),i=t("br_calc"),c=t("br_reset"),u=t("br_result"),d=t("br_breakdown");function p(){n.style.display="ah"===a.value?"block":"none"}function f(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display="block")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",p),p(),i.addEventListener("click",function e(){g();let t=parseFloat(l.value);if(!t||t<=0)return f(l,"Enter battery capacity.");let n;if("ah"===a.value){let i=parseFloat(r.value);if(!i||i<=0)return f(r,"Enter valid voltage.");n=t*i}else n=t;let c=parseFloat(s.value);if(!c||c<=0)return f(s,"Enter valid load power (W).");let p=parseFloat(o.value);(!p||p<=0||p>100)&&(p=100);let h=n*(p/100),v=h/c,m=Math.floor(v),$=[];$.push(`<h2 class="fade-left"><strong>Estimated Runtime:</strong> ${m}h ${Math.floor((v-m)*60)}m</h2>`),$.push(`<p class="fade-left ad1"><strong>Battery Energy:</strong> ${n.toFixed(1)} Wh</p>`),$.push(`<p class="fade-left ad2"><strong>Usable Energy (eff applied):</strong> ${h.toFixed(1)} Wh</p>`),$.push(`<p class="fade-left ad3"><strong>Load Consumption:</strong> ${c} W</p>`),$.push('<p class="fade-left ad4 small">Real runtime may vary depending on load spikes, temperature, and battery age.</p>'),d.innerHTML=$.join(""),u.hidden=!1}),c.addEventListener("click",function e(){l.value="",r.value="",s.value="",o.value="",a.value="wh",p(),g(),u.hidden=!0})}(),function(){let e=document.getElementById("battery_discharge_time_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("bd_capacity"),a=t("bd_unit"),n=t("bd_voltage_wrap"),r=t("bd_voltage"),s=t("bd_load"),o=t("bd_calc"),i=t("bd_reset"),c=t("bd_result"),u=t("bd_breakdown");function d(){n.style.display="ah"===a.value?"block":"none"}function p(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display="block")}function f(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",d),d(),o.addEventListener("click",function e(){f();let t=parseFloat(l.value);if(!t||t<=0)return p(l,"Enter valid battery capacity.");let n;if("ah"===a.value){let o=parseFloat(r.value);if(!o||o<=0)return p(r,"Enter valid voltage.");n=t*o}else n=t;let i=parseFloat(s.value);if(!i||i<=0)return p(s,"Enter a valid watt load.");let d=n/i,g=Math.floor(d),h=[];h.push(`<h2 class="fade-left"><strong>Runtime:</strong> ${g}h ${Math.floor((d-g)*60)}m</h2>`),h.push(`<p class="fade-left ad1"><strong>Battery Energy:</strong> ${n.toFixed(2)} Wh</p>`),h.push(`<p class="fade-left ad2"><strong>Load:</strong> ${i} W</p>`),h.push('<p class="small fade-left ad3">This is an ideal DC discharge estimate. Actual results vary with temperature, age, and voltage sag.</p>'),u.innerHTML=h.join(""),c.hidden=!1}),i.addEventListener("click",function e(){l.value="",r.value="",s.value="",a.value="wh",d(),f(),c.hidden=!0})}(),function(){let e=document.getElementById("battery_storage_loss_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("bsl_capacity"),a=t("bsl_unit"),n=t("bsl_voltage_wrap"),r=t("bsl_voltage"),s=t("bsl_chem"),o=t("bsl_custom_rate_wrap"),i=t("bsl_custom_rate"),c=t("bsl_months"),u=t("bsl_calc"),d=t("bsl_reset"),p=t("bsl_result"),f=t("bsl_breakdown"),g={liion:3,lifepo4:2,lto:1,solid:1.5,leadacid:5,nimh:10};function h(){n.style.display="ah"===a.value?"block":"none"}function v(){o.style.display="custom"===s.value?"block":"none"}function m(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display="block")}function $(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",h),h(),s.addEventListener("change",v),v(),u.addEventListener("click",function e(){$();let t=parseFloat(l.value);if(!t||t<=0)return m(l,"Enter valid capacity.");let n;if("ah"===a.value){let o=parseFloat(r.value);if(!o||o<=0)return m(r,"Enter valid voltage.");n=t*o}else n=t;let u=parseFloat(c.value);if(!u||u<0)return m(c,"Enter valid number of months.");let d;if("custom"===s.value){if(!(d=parseFloat(i.value))||d<=0)return m(i,"Enter valid custom rate.")}else d=g[s.value];let h=n*Math.pow(1-d/100,u),v=n-h,y=h/n*100,E=[];E.push(`<h2 class="fade-left"><strong>Remaining Capacity:</strong> ${h.toFixed(1)} Wh (${y.toFixed(1)}%)</h2>`),E.push(`<p class="fade-left ad1"><strong>Initial Capacity:</strong> ${n.toFixed(1)} Wh</p>`),E.push(`<p class="fade-left ad2"><strong>Total Loss:</strong> ${v.toFixed(1)} Wh</p>`),E.push(`<p class="fade-left ad3"><strong>Monthly Loss Rate:</strong> ${d}%</p>`),E.push(`<p class="fade-left ad4"><strong>Months Stored:</strong> ${u}</p>`),E.push('<p class="small fade-left ad5">Actual loss varies with temperature, state of charge, storage conditions, and battery age.</p>'),f.innerHTML=E.join(""),p.hidden=!1}),d.addEventListener("click",function e(){l.value="",r.value="",c.value="",a.value="wh",s.value="liion",i.value="",v(),h(),$(),p.hidden=!0})}(),function(){let e=document.getElementById("inverter_runtime_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ir_capacity"),a=t("ir_unit"),n=t("ir_voltage_wrap"),r=t("ir_voltage"),s=t("ir_eff"),o=t("ir_idle"),i=t("ir_load"),c=t("ir_calc"),u=t("ir_reset"),d=t("ir_result"),p=t("ir_breakdown");function f(){n.style.display="ah"===a.value?"block":"none"}function g(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display="block")}function h(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),a.addEventListener("change",f),f(),c.addEventListener("click",function e(){h();let t=parseFloat(l.value);if(!t||t<=0)return g(l,"Enter valid battery capacity.");let n;if("ah"===a.value){let c=parseFloat(r.value);if(!c||c<=0)return g(r,"Enter valid voltage.");n=t*c}else n=t;let u=parseFloat(s.value);(!u||u<=0||u>100)&&(u=100);let f=parseFloat(o.value);(!f||f<0)&&(f=0);let v=parseFloat(i.value);if(!v||v<=0)return g(i,"Enter valid AC load (W).");let m=n*(u/100),$=v+f,y=m/$,E=Math.floor(y),_=[];_.push(`<h2 class="fade-left"><strong>Estimated Runtime:</strong> ${E}h ${Math.floor((y-E)*60)}m</h2>`),_.push(`<p class="fade-left ad1"><strong>Battery Energy:</strong> ${n.toFixed(1)} Wh</p>`),_.push(`<p class="fade-left ad2"><strong>Usable Energy (eff applied):</strong> ${m.toFixed(1)} Wh</p>`),_.push(`<p class="fade-left ad3"><strong>AC Load:</strong> ${v} W</p>`),_.push(`<p class="fade-left ad4"><strong>Inverter Idle Load:</strong> ${f} W</p>`),_.push(`<p class="fade-left ad5"><strong>Total Load:</strong> ${$} W</p>`),_.push('<p class="small fade-left ad6">Actual runtime varies with inverter temperature, wiring efficiency, battery age, voltage sag, and surge events.</p>'),p.innerHTML=_.join(""),d.hidden=!1}),u.addEventListener("click",function e(){l.value="",r.value="",s.value="",o.value="",i.value="",a.value="wh",f(),h(),d.hidden=!0})}(),function(){let e=document.getElementById("charger_selector_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ucs_voltage"),a=t("ucs_capacity"),n=t("ucs_unit"),r=t("ucs_c_rate"),s=t("ucs_calc"),o=t("ucs_reset"),i=t("ucs_result"),c=t("ucs_breakdown");function u(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function d(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),s.addEventListener("click",function e(){d();let t=parseFloat(l.value);if(!t||t<=0){u(l,"Enter valid battery voltage.");return}let s=parseFloat(a.value);if(!s||s<=0){u(a,"Enter battery capacity.");return}let o;o="ah"===n.value?s*t:s;let p=o/t,f=parseFloat(r.value),g=p*f,h="";h=f<=.2?"Excellent for long battery life.":f<=.5?"Safe charging rate for most lithium batteries.":f<=1?"Fast charging — ensure battery is high-quality and well-cooled.":"⚠️ Unsafe: Do NOT charge above 1C without manufacturer approval.";let v=[];v.push('<h2 class="fade-left"><strong>Recommended Charger Specs</strong></h2>'),v.push(`<p class="fade-left ad1"><strong>Battery Capacity:</strong> ${p.toFixed(2)} Ah (${o.toFixed(1)} Wh)</p>`),v.push(`<p class="fade-left ad2"><strong>Charge Current (A):</strong> ${g.toFixed(2)} A</p>`),v.push(`<p class="fade-left ad3"><strong>Charger Wattage:</strong> ${(g*t).toFixed(1)} W</p>`),v.push(`<p class="fade-left ad4"><strong>Estimated Charge Time:</strong> ${(p/g).toFixed(1)} hours</p>`),v.push(`<p class="fade-left ad5">${h}</p>`),v.push('<p class="small fade-left ad6">A charger must match your battery chemistry (Li-ion / LiFePO4 / Lead-acid) and CC/CV profile.</p>'),c.innerHTML=v.join(""),i.hidden=!1}),o.addEventListener("click",function e(){l.value="",a.value="",n.value="ah",r.value="0.2",d(),i.hidden=!0})}(),function(){let e=document.getElementById("wire_gauge_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("wg_current"),a=t("wg_length"),n=t("wg_voltage"),r=t("wg_drop"),s=t("wg_calc"),o=t("wg_reset"),i=t("wg_result"),c=t("wg_breakdown"),u=[{awg:20,mm2:.52},{awg:18,mm2:.82},{awg:16,mm2:1.31},{awg:14,mm2:2.08},{awg:12,mm2:3.31},{awg:10,mm2:5.26},{awg:8,mm2:8.37},{awg:6,mm2:13.3},{awg:4,mm2:21.1},{awg:2,mm2:33.6},{awg:1,mm2:42.4},{awg:0,mm2:53.5},{awg:-1,mm2:67.4},{awg:-2,mm2:85},{awg:-3,mm2:107}];function d(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),s.addEventListener("click",function e(){p();let t=parseFloat(l.value),s=parseFloat(a.value),o=parseFloat(n.value),f=parseFloat(r.value);if(!t||t<=0){d(l,"Enter valid current.");return}if(!s||s<=0){d(a,"Enter valid distance.");return}if(!o||o<=0){d(n,"Enter valid voltage.");return}if(!f||f<=0){d(r,"Enter acceptable voltage drop.");return}let g=2*s,h=.0172*g*t/(f/100*o),v=function e(t){for(let l=0;l<u.length;l++)if(u[l].mm2>=t)return u[l];return u[u.length-1]}(h),m=.0172*g/v.mm2,$=t*m,y=$/o*100,E=[];E.push('<h2 class="fade-left"><strong>Recommended Wire Size</strong></h2>'),E.push(`<p class="fade-left ad1"><strong>Required Minimum:</strong> ${h.toFixed(2)} mm\xb2</p>`),E.push(`<p class="fade-left ad2"><strong>Suggested AWG:</strong> ${v.awg<0?Math.abs(v.awg)+" / 0 AWG":v.awg}</p>`),E.push(`<p class="fade-left ad3"><strong>Suggested mm\xb2:</strong> ${v.mm2} mm\xb2</p>`),E.push("<hr>"),E.push('<h3 class="fade-left ad4">Performance With Suggested Wire</h3>'),E.push(`<p class="fade-left ad5"><strong>Voltage Drop:</strong> ${$.toFixed(3)} V (${y.toFixed(2)}%)</p>`),E.push(`<p class="fade-left ad6"><strong>Power Loss:</strong> ${(t*$).toFixed(2)} W</p>`),E.push('<p class="small fade-left ad7">Lower voltage drop = less heat, better performance, and longer wire lifespan.</p>'),y>f&&E.push(`<p class="fade-left ad8" style="color:red"><strong>⚠️ Voltage drop exceeds your target. Consider thicker wire.</strong></p>`),v.mm2<2.5&&t>15&&E.push(`<p class="fade-left ad9" style="color:red"><strong>⚠️ Load too high for thin wires — overheating risk.</strong></p>`),c.innerHTML=E.join(""),i.hidden=!1}),o.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",p(),i.hidden=!0})}(),function(){let e=document.getElementById("voltage_drop_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("vdc_voltage"),a=t("vdc_current"),n=t("vdc_length"),r=t("vdc_material"),s=t("vdc_calc"),o=t("vdc_reset"),i=t("vdc_result"),c=t("vdc_breakdown"),u=[{awg:20,mm2:.52},{awg:18,mm2:.82},{awg:16,mm2:1.31},{awg:14,mm2:2.08},{awg:12,mm2:3.31},{awg:10,mm2:5.26},{awg:8,mm2:8.37},{awg:6,mm2:13.3},{awg:4,mm2:21.1},{awg:2,mm2:33.6},{awg:1,mm2:42.4},{awg:0,mm2:53.5},{awg:-1,mm2:67.4},{awg:-2,mm2:85},{awg:-3,mm2:107}];function d(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function p(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),s.addEventListener("click",function e(){p();let t=parseFloat(l.value),s=parseFloat(a.value),o=parseFloat(n.value);if(!t||t<=0){d(l,"Enter system voltage.");return}if(!s||s<=0){d(a,"Enter current.");return}if(!o||o<=0){d(n,"Enter wire length.");return}let f=r.value,g="cu"===f?.0172:.0282,h=2*o,v=g*h*s/(.03*t),m=function e(t){for(let l of u)if(l.mm2>=t)return l;return u[u.length-1]}(v),$=g*h/m.mm2,y=s*$,E=y/t*100,_=[];_.push('<h2 class="fade-left"><strong>Voltage Drop Result</strong></h2>'),_.push(`<p class="fade-left ad1"><strong>Voltage Drop:</strong> ${y.toFixed(3)} V (${E.toFixed(2)}%)</p>`),_.push(`<p class="fade-left ad2"><strong>Power Lost as Heat:</strong> ${(s*y).toFixed(2)} W</p>`),_.push("<hr>"),_.push('<h3 class="fade-left ad3">Recommended Wire Size</h3>'),_.push(`<p class="fade-left ad4"><strong>Minimum Required:</strong> ${v.toFixed(2)} mm\xb2</p>`),_.push(`<p class="fade-left ad5"><strong>Recommended AWG:</strong> ${m.awg<0?Math.abs(m.awg)+"/0 AWG":m.awg}</p>`),_.push(`<p class="fade-left ad6"><strong>Wire Cross-Section:</strong> ${m.mm2} mm\xb2</p>`),"al"===f&&_.push(`<p class="small fade-left ad7" style="color:#d9534f">⚠ Aluminum wire has higher resistance — always use thicker size than copper.</p>`),E>3&&_.push(`<p class="fade-left ad8" style="color:red"><strong>⚠ Voltage drop higher than recommended 2–3%. Use thicker wire.</strong></p>`),_.push('<p class="small fade-left ad9">Lower voltage drop means cooler wire, higher efficiency, and better system performance.</p>'),c.innerHTML=_.join(""),i.hidden=!1}),o.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="cu",p(),i.hidden=!0})}(),function(){let e=document.getElementById("fuse_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("fs_current"),a=t("fs_wire"),n=t("fs_voltage"),r=t("fs_calc_btn"),s=t("fs_reset_btn"),o=t("fs_result"),i=t("fs_breakdown"),c={22:7,20:11,18:16,16:22,14:32,12:41,10:55,8:73,6:101,4:135,2:181};function u(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),r.addEventListener("click",function e(){u();let t=parseFloat(l.value);if(!t||t<=0){!function e(t,l){let a=t.parentElement.querySelector(".error-message");a&&(a.textContent=l,a.style.display=l?"block":"none")}(l,"Enter valid current.");return}let r=parseFloat(a.value)||null,s=parseFloat(n.value)||null,d=1.25*t,p=[5,7.5,10,15,20,25,30,40,50,60,80,100,150,200,250,300],f=p.find(e=>e>=d)||p[p.length-1],g=[];if(g.push('<h2 class="fade-left"><strong>Recommended Fuse Rating</strong></h2>'),g.push(`<p class="fade-left ad1"><strong>Continuous Load:</strong> ${t} A</p>`),g.push(`<p class="fade-left ad2"><strong>Fuse Range (safe):</strong> ${d.toFixed(1)} – ${(1.5*t).toFixed(1)} A</p>`),g.push(`<p class="fade-left ad3"><strong>Recommended Fuse:</strong> ${f} A</p>`),g.push("<hr>"),r){let h=c[r];h?(g.push(`<p class="fade-left ad4"><strong>Wire Gauge:</strong> AWG ${r}</p>`),g.push(`<p class="fade-left ad5"><strong>Max Safe Wire Current:</strong> ${h} A</p>`),f>h?(g.push(`<p class="fade-left ad6" style="color:red"><strong>⚠️ Fuse too large for this wire — overheating and fire risk!</strong></p>`),g.push('<p class="fade-left ad7 small">Choose thicker wire or smaller fuse.</p>')):g.push(`<p class="fade-left ad8" style="color:green"><strong>✓ Fuse is safe for the selected wire gauge.</strong></p>`)):g.push(`<p class="small fade-left ad9">Unknown AWG size — skipping wire safety check.</p>`),g.push("<hr>")}if(s){let v="Low-Voltage Automotive / Blade Fuse";s>60&&(v="High-Voltage DC Fuse (ANL / MIDI / MEGA)"),s>100&&(v="EV-Rated HV Fuse (DC Rated 250-500V)"),g.push('<h3 class="fade-left ad10">Fuse Type Recommendation</h3>'),g.push(`<p class="fade-left ad11">${v}</p>`)}g.push('<p class="small fade-left ad12">Fuses protect wires from fire, not devices. Always size fuse to wire capacity.</p>'),i.innerHTML=g.join(""),o.hidden=!1}),s.addEventListener("click",function e(){l.value="",a.value="",n.value="",u(),o.hidden=!0})}(),function(){let e=document.getElementById("motor_kv_kt_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("mk_kv"),a=t("mk_kt"),n=t("mk_voltage"),r=t("mk_current"),s=t("mk_gear"),o=t("mk_wheel_radius"),i=t("mk_eff"),c=t("mk_calc"),u=t("mk_reset"),d=t("mk_result"),p=t("mk_breakdown");function f(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function g(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}let h=60/(2*Math.PI);c.addEventListener("click",function e(){g(),d.hidden=!0;let t=l.value.trim(),c=a.value.trim();if(""===t&&""===c){f(l,"Enter Kv (RPM/V) or Kt (Nm/A)."),f(a,"Enter Kv (RPM/V) or Kt (Nm/A).");return}let u=""!==t?parseFloat(t):null,v=""!==c?parseFloat(c):null;if(null!==u&&(!isFinite(u)||u<=0)){f(l,"Kv must be > 0");return}if(null!==v&&(!isFinite(v)||v<=0)){f(a,"Kt must be > 0");return}let m=u,$=v;if(null!==u&&null===v)$=h/u;else if(null!==v&&null===u)m=h/v;else{let y=h/u;Math.abs(y-v)/y>.05?(f(a,"Provided Kv and Kt differ by >5% — check inputs."),$=y,m=u):($=(y+v)/2,m=(h/v+u)/2)}let E=2*m*Math.PI/60,_=141.611932*$,b=""!==n.value.trim()?parseFloat(n.value):null,x=""!==r.value.trim()?parseFloat(r.value):null,k=""!==s.value.trim()?parseFloat(s.value):1,L=""!==o.value.trim()?parseFloat(o.value):null,w=""!==i.value.trim()?parseFloat(i.value):.95;if(null!==b&&(!isFinite(b)||b<=0)){f(n,"Voltage must be > 0");return}if(null!==x&&(!isFinite(x)||x<0)){f(r,"Current must be ≥ 0");return}if(null!==k&&(!isFinite(k)||k<=0)){f(s,"Gear ratio must be > 0");return}if(null!==L&&(!isFinite(L)||L<=0)){f(o,"Wheel radius must be > 0");return}if(null!==w&&(!isFinite(w)||w<=0||w>1.5)){f(i,"Efficiency should be 0.5–1.0 (use 0.95 default)");return}let S=[];if(S.push('<h2 class="fade-left"><strong>Conversion</strong></h2>'),S.push(`<p class="fade-left ad1"><strong>Kv (RPM/V):</strong> ${m.toFixed(3)} rpm/V</p>`),S.push(`<p class="fade-left ad2"><strong>Kt (Nm/A):</strong> ${$.toFixed(5)} Nm/A</p>`),S.push(`<p class="fade-left ad3"><strong>Kv (rad/s per V):</strong> ${E.toFixed(3)} rad\xb7s⁻\xb9\xb7V⁻\xb9</p>`),S.push(`<p class="fade-left ad4"><strong>Kt (oz\xb7in / A):</strong> ${_.toFixed(2)} oz\xb7in/A</p>`),null!==b){let C=m*b;S.push(`<p class="fade-left ad5"><strong>No-load speed:</strong> ${C.toFixed(0)} rpm (${(C/1e3).toFixed(3)} krpm) — ${(2*C*Math.PI/60).toFixed(0)} rad/s</p>`)}let F=null;if(null!==x&&(F=$*x,S.push(`<p class="fade-left ad6"><strong>Motor torque (stall at ${x} A):</strong> ${F.toFixed(3)} Nm</p>`)),null!==F||null!==b){let A=null!==b?m*b:null;if(null!==F){let q=F*k*w;S.push(`<p class="fade-left ad7"><strong>Wheel torque (after ${k} : 1 gear & ${(100*w).toFixed(0)}% eff):</strong> ${q.toFixed(3)} Nm</p>`),null!==L&&S.push(`<p class="fade-left ad8"><strong>Wheel linear force:</strong> ${(q/L).toFixed(2)} N</p>`)}if(null!==A&&null!==L){let W=A/k;S.push(`<p class="fade-left ad9"><strong>Wheel speed:</strong> ${(60*(2*Math.PI*L*W)/1e3).toFixed(2)} km/h (wheel RPM: ${W.toFixed(1)} rpm)</p>`)}if(null!==F&&null!==A){let B=F*(2*A*Math.PI/60);S.push(`<p class="fade-left ad10"><strong>Mechanical power at motor:</strong> ${B.toFixed(0)} W</p>`)}}S.push(`<p class="small fade-left ad11">Formula: Kt (Nm/A) = 60 / (2π \xd7 Kv). This assumes SI units and ideal motor (no losses). Use gearbox efficiency to estimate wheel torque.</p>`),p.innerHTML=S.join(""),d.hidden=!1}),u.addEventListener("click",function e(){l.value="",a.value="",n.value="",r.value="",s.value="",o.value="",i.value="",g(),d.hidden=!0})}(),function(){let e=document.getElementById("dc_motor_rpm_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("dcm_kv"),a=t("dcm_voltage"),n=t("dcm_calc"),r=t("dcm_reset"),s=t("dcm_result"),o=t("dcm_breakdown");function i(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function c(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),n.addEventListener("click",function e(){c(),s.hidden=!0;let t=parseFloat(l.value);if(!t||t<=0){i(l,"Enter a valid Kv value.");return}let n=parseFloat(a.value);if(!n||n<=0){i(a,"Enter valid voltage.");return}let r=[];r.push(`<h2 class="fade-left"><strong>Motor RPM:</strong> ${(t*n).toFixed(0)} rpm</h2>`),r.push(`<p class="fade-left ad1"><strong>Kv:</strong> ${t} RPM per Volt</p>`),r.push(`<p class="fade-left ad2"><strong>Voltage:</strong> ${n} V</p>`),r.push(`<p class="fade-left ad3"><strong>Formula:</strong> RPM = Kv \xd7 Voltage</p>`),r.push(`<p class="small fade-left ad4">Note: This is no-load RPM. Under real load, RPM is 10–20% lower.</p>`),o.innerHTML=r.join(""),s.hidden=!1}),r.addEventListener("click",function e(){l.value="",a.value="",s.hidden=!0,c()})}(),function(){let e=document.getElementById("motor_kv_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("mk_rpm"),a=t("mk_voltage"),n=t("mk_calc"),r=t("mk_reset"),s=t("mk_result"),o=t("mk_breakdown");function i(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function c(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),n.addEventListener("click",function e(){c(),s.hidden=!0;let t=parseFloat(l.value);if(!t||t<=0){i(l,"Enter valid RPM.");return}let n=parseFloat(a.value);if(!n||n<=0){i(a,"Enter valid voltage.");return}let r=[];r.push(`<h2 class="fade-left"><strong>Motor Kv:</strong> ${(t/n).toFixed(2)} RPM/V</h2>`),r.push(`<p class="fade-left ad1"><strong>No-Load RPM:</strong> ${t} rpm</p>`),r.push(`<p class="fade-left ad2"><strong>Voltage:</strong> ${n} V</p>`),r.push(`<p class="fade-left ad3"><strong>Formula:</strong> Kv = RPM \xf7 Voltage</p>`),r.push("<hr>"),r.push(`<p class="small fade-left ad4">Note: Kv is calculated from no-load RPM. Loaded RPM will be 10–20% lower.</p>`),o.innerHTML=r.join(""),s.hidden=!1}),r.addEventListener("click",function e(){l.value="",a.value="",s.hidden=!0,c()})}(),function(){let e=document.getElementById("ev_charging_time_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("ev_battery"),a=t("ev_charger"),n=t("ev_eff"),r=t("ev_calc_btn"),s=t("ev_reset_btn"),o=t("ev_result"),i=t("ev_breakdown");function c(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function u(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.]/g,"");t.startsWith(".")&&(t="0"+t);let l=t.split(".");l.length>2&&(t=l[0]+"."+l.slice(1).join("")),e.value=t})}),r.addEventListener("click",function e(){u(),o.hidden=!0;let t=parseFloat(l.value);if(!t||t<=0){c(l,"Enter valid battery capacity.");return}let r=parseFloat(a.value);if(!r||r<=0){c(a,"Enter valid charger power.");return}let s=parseFloat(n.value);(!s||s<=0||s>100)&&(s=90);let d=s/100,p=t/(r*d),f=[];f.push(`<h2 class="fade-left"><strong>Charging Time:</strong> ${p.toFixed(2)} hours</h2>`),f.push(`<p class="fade-left ad1"><strong>≈ ${(60*p).toFixed(0)} minutes</strong></p>`),f.push(`<p class="fade-left ad2"><strong>Battery Capacity:</strong> ${t} kWh</p>`),f.push(`<p class="fade-left ad3"><strong>Charger Power:</strong> ${r} kW</p>`),f.push(`<p class="fade-left ad4"><strong>Charging Efficiency:</strong> ${s}%</p>`),f.push(`<p class="small fade-left ad5">
      Note: EV chargers rarely achieve 100% efficiency. Realistic values are 85%–93%.
    </p>`),i.innerHTML=f.join(""),o.hidden=!1}),s.addEventListener("click",function e(){l.value="",a.value="",n.value="",u(),o.hidden=!0})}(),function(){let e=document.getElementById("ev_temp_range_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("evtr_base_range"),a=t("evtr_temp"),n=t("evtr_calc"),r=t("evtr_reset"),s=t("evtr_result"),o=t("evtr_breakdown");function i(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function c(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}e.querySelectorAll("input[type=number]").forEach(e=>{e.addEventListener("input",()=>{let t=e.value.replace(/[^0-9.-]/g,"");t.split(".").length>2&&(t=t.replace(/\.+$/,"")),(t.match(/-/g)||[]).length>1&&(t=t.replace(/-+$/,"")),t.startsWith(".")&&(t="0"+t),e.value=t})}),n.addEventListener("click",function e(){c(),s.hidden=!0;let t=parseFloat(l.value);if(!t||t<=0){i(l,"Enter a valid base range.");return}let n=parseFloat(a.value);if(""===n||isNaN(n)){i(a,"Enter a valid temperature.");return}let r=function e(t){let l=[{t:-20,loss:45},{t:-10,loss:35},{t:0,loss:20},{t:10,loss:10},{t:20,loss:0},{t:30,loss:5},{t:40,loss:12}];if(t<=-20)return 45;if(t>=40)return 12;for(let a=0;a<l.length-1;a++){let n=l[a],r=l[a+1];if(t>=n.t&&t<=r.t){let s=(t-n.t)/(r.t-n.t);return n.loss+(r.loss-n.loss)*s}}return 0}(n),u=[];u.push(`<h2 class="fade-left"><strong>Estimated Range:</strong> ${(t*(1-r/100)).toFixed(1)} km</h2>`),u.push(`<p class="fade-left ad1"><strong>Temperature:</strong> ${n}\xb0C</p>`),u.push(`<p class="fade-left ad2"><strong>Efficiency Loss:</strong> ${r.toFixed(1)}%</p>`),u.push(`<p class="fade-left ad3"><strong>Original Range:</strong> ${t} km</p>`),u.push("<hr>");let d="";u.push(`<p class="small fade-left ad4">${d=n<0?"Cold batteries have higher internal resistance and reduced regen braking.":n>30?"Hot weather increases AC load and battery cooling demand.":"Temperature is within optimal range."}</p>`),o.innerHTML=u.join(""),s.hidden=!1}),r.addEventListener("click",function e(){l.value="",a.value="",c(),s.hidden=!0})}(),function(){let e=document.getElementById("ev_tire_diff_calc");if(!e)return;let t=t=>e.querySelector("#"+t),l=t("etd_old"),a=t("etd_new"),n=t("etd_speed"),r=t("etd_calc"),s=t("etd_reset"),o=t("etd_result"),i=t("etd_breakdown");function c(e,t){let l=e.parentElement.querySelector(".error-message");l&&(l.textContent=t,l.style.display=t?"block":"none")}function u(){e.querySelectorAll(".error-message").forEach(e=>{e.textContent="",e.style.display="none"})}function d(e){let t=e.trim().match(/^(\d{3})\/(\d{2})R(\d{2})$/i);return t?{width:parseFloat(t[1]),aspect:parseFloat(t[2]),rim:parseFloat(t[3])}:null}function p(e){let t=e.width*(e.aspect/100)*2,l=25.4*e.rim;return t+l}n&&n.addEventListener("input",()=>{let e=n.value.replace(/[^0-9.]/g,"");e.startsWith(".")&&(e="0"+e);let t=e.split(".");t.length>2&&(e=t[0]+"."+t.slice(1).join("")),n.value=e}),r.addEventListener("click",function e(){u(),o.hidden=!0;let t=d(l.value);if(!t){c(l,"Invalid tire format.");return}let r=d(a.value);if(!r){c(a,"Invalid tire format.");return}let s=p(t),f=p(r),g=(f-s)/s*100,h=parseFloat(n.value),v=null;h&&h>0&&(v=h*(f/s));let m=0;m=g>0?1.2*g:.8*g;let $=[];$.push(`<h2 class="fade-left"><strong>Diameter Difference:</strong> ${g.toFixed(2)}%</h2>`),$.push(`<p class="fade-left ad1"><strong>Old Diameter:</strong> ${s.toFixed(1)} mm</p>`),$.push(`<p class="fade-left ad2"><strong>New Diameter:</strong> ${f.toFixed(1)} mm</p>`),null!==v&&($.push(`<p class="fade-left ad3"><strong>Actual Speed:</strong> ${v.toFixed(1)} km/h</p>`),$.push('<p class="small fade-left ad4">Because new tire diameter affects wheel rotations per km.</p>')),$.push("<hr>"),$.push(`<h3 class="fade-left ad5"><strong>Estimated Range Change:</strong> ${m.toFixed(1)}%</h3>`),g>0?$.push('<p class="small fade-left ad6">Bigger tires reduce torque and increase energy usage.</p>'):$.push('<p class="small fade-left ad7">Smaller tires improve efficiency but reduce top speed.</p>'),i.innerHTML=$.join(""),o.hidden=!1}),s.addEventListener("click",function e(){l.value="",a.value="",n.value="",o.hidden=!0,u()})}(),document.querySelectorAll(".tool-opener").forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-modal");openModal(e)})}),document.querySelectorAll(".close-btn").forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-modal");closeModal(e)})}),window.addEventListener("click",function(e){let t=document.querySelectorAll(".modal");t.forEach(t=>{e.target===t&&closeModal(t.id)})}),document.querySelector(".navbar-toggler").addEventListener("click",function(){let e=document.querySelector(".main-nav");e.classList.toggle("active")}),document.querySelectorAll(".dropdown-menu > a").forEach(function(e){e.addEventListener("click",function(t){let l=e.nextElementSibling;l.style.display="block"===l.style.display?"none":"block"})});const pageURL=window.location.href,pageTitle=document.title,pageDescription="Best place to buy batteries online!",pageImage="https://batterywheel.com/images/logo.jpg";document.querySelector(".social-icon.facebook").href=`https://www.facebook.com/sharer/sharer.php?u=${pageURL}`,document.querySelector(".social-icon.twitter").href=`https://twitter.com/intent/tweet?url=${pageURL}&text=${pageTitle}`,document.querySelector(".social-icon.linkedin").href=`https://www.linkedin.com/shareArticle?mini=true&url=${pageURL}&title=${pageTitle}&summary=${pageDescription}`,document.querySelector(".social-icon.whatsapp").href=`https://wa.me/?text=${pageTitle} ${pageURL}`,document.querySelector(".social-icon.pinterest").href=`https://pinterest.com/pin/create/button/?url=${pageURL}&media=https://batterywheel.com/images/logo.jpg&description=${pageDescription}`,document.querySelector(".social-icon.reddit").href=`https://www.reddit.com/submit?url=${pageURL}&title=${pageTitle}`,document.querySelector(".social-icon.telegram").href=`https://t.me/share/url?url=${pageURL}&text=${pageDescription}`,document.querySelector(".social-icon.tumblr").href=`https://www.tumblr.com/share/link?url=${pageURL}&name=${pageTitle}&description=${pageDescription}`;
